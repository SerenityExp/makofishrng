--[[
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  TEMPEST v3.2                                                   â•‘
    â•‘  Ultra BillboardGui Editor + Combat Tools                       â•‘
    â•‘  Enhanced Anti-Kick + Script Neutralization + Key System        â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
]]

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local CollectionService = game:GetService("CollectionService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Lighting = game:GetService("Lighting")
local ReplicatedFirst = game:GetService("ReplicatedFirst")
local StarterGui = game:GetService("StarterGui")
local CoreGui = game:GetService("CoreGui")
local ScriptContext = game:GetService("ScriptContext")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local character = player.Character or player.CharacterAdded:Wait()
player.CharacterAdded:Connect(function(char) character = char end)
local Camera = workspace.CurrentCamera

--------------------------------------------------------------
-- KEY SYSTEM
--------------------------------------------------------------
local VALID_KEY = "Tempest-R:C]77kB2<\\@I=sN5Ho\\cGo;=QFN.<}5z]Y"
local keyVerified = false

local function runKeySystem()
    local keyGui = Instance.new("ScreenGui"); keyGui.Name="TempestKey"; keyGui.ResetOnSpawn=false; keyGui.IgnoreGuiInset=true; keyGui.DisplayOrder=999; keyGui.ZIndexBehavior=Enum.ZIndexBehavior.Sibling; keyGui.Parent=playerGui
    local overlay = Instance.new("Frame",keyGui); overlay.Size=UDim2.new(1,0,1,0); overlay.BackgroundColor3=Color3.fromRGB(10,10,12); overlay.BackgroundTransparency=1; overlay.BorderSizePixel=0
    TweenService:Create(overlay,TweenInfo.new(0.6,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{BackgroundTransparency=0.15}):Play()
    local ph=Instance.new("Frame",overlay); ph.Size=UDim2.new(1,0,1,0); ph.BackgroundTransparency=1; ph.ClipsDescendants=true
    for i=1,30 do task.defer(function() local d=Instance.new("Frame",ph); d.Size=UDim2.new(0,math.random(2,5),0,math.random(2,5)); d.BackgroundColor3=Color3.fromRGB(0,math.random(100,204),math.random(180,255)); d.BackgroundTransparency=math.random(40,80)/100; d.BorderSizePixel=0; Instance.new("UICorner",d).CornerRadius=UDim.new(1,0); local sx=math.random(0,100)/100; d.Position=UDim2.new(sx,0,1.1,0); TweenService:Create(d,TweenInfo.new(math.random(40,90)/10,Enum.EasingStyle.Linear,Enum.EasingDirection.InOut,-1,false,math.random(0,30)/10),{Position=UDim2.new(sx+(math.random(-20,20)/100),0,-0.1,0),BackgroundTransparency=1}):Play() end) end
    local card=Instance.new("Frame",overlay); card.Size=UDim2.new(0,420,0,310); card.Position=UDim2.new(0.5,-210,0.5,200); card.BackgroundColor3=Color3.fromRGB(25,25,28); card.BorderSizePixel=0; card.ClipsDescendants=true; Instance.new("UICorner",card).CornerRadius=UDim.new(0,12)
    local cs=Instance.new("Frame",overlay); cs.Size=UDim2.new(0,430,0,320); cs.Position=UDim2.new(0.5,-215,0.5,195); cs.BackgroundColor3=Color3.fromRGB(0,0,0); cs.BackgroundTransparency=0.6; cs.BorderSizePixel=0; cs.ZIndex=card.ZIndex-1; Instance.new("UICorner",cs).CornerRadius=UDim.new(0,14)
    local ctp=UDim2.new(0.5,-210,0.5,-155); task.wait(0.3)
    TweenService:Create(card,TweenInfo.new(0.7,Enum.EasingStyle.Back,Enum.EasingDirection.Out),{Position=ctp}):Play()
    TweenService:Create(cs,TweenInfo.new(0.7,Enum.EasingStyle.Back,Enum.EasingDirection.Out),{Position=UDim2.new(0.5,-215,0.5,-160)}):Play()
    local ab=Instance.new("Frame",card); ab.Size=UDim2.new(1,0,0,4); ab.BackgroundColor3=Color3.fromRGB(0,122,204); ab.BorderSizePixel=0; Instance.new("UICorner",ab).CornerRadius=UDim.new(0,12)
    task.defer(function() local cols={Color3.fromRGB(0,122,204),Color3.fromRGB(0,200,150),Color3.fromRGB(100,80,255),Color3.fromRGB(0,180,255)}; local ci=1; while ab and ab.Parent do ci=(ci%#cols)+1; TweenService:Create(ab,TweenInfo.new(2,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut),{BackgroundColor3=cols[ci]}):Play(); task.wait(2) end end)
    local lf=Instance.new("Frame",card); lf.Size=UDim2.new(0,50,0,50); lf.Position=UDim2.new(0.5,-25,0,20); lf.BackgroundColor3=Color3.fromRGB(0,122,204); lf.BorderSizePixel=0; Instance.new("UICorner",lf).CornerRadius=UDim.new(0,12)
    local lt=Instance.new("TextLabel",lf); lt.Size=UDim2.new(1,0,1,0); lt.BackgroundTransparency=1; lt.Text="âš¡"; lt.TextColor3=Color3.fromRGB(255,255,255); lt.TextSize=28; lt.Font=Enum.Font.GothamBold
    task.defer(function() while lf and lf.Parent do TweenService:Create(lf,TweenInfo.new(1.2,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut),{Size=UDim2.new(0,55,0,55),Position=UDim2.new(0.5,-27.5,0,17.5)}):Play(); task.wait(1.2); TweenService:Create(lf,TweenInfo.new(1.2,Enum.EasingStyle.Sine,Enum.EasingDirection.InOut),{Size=UDim2.new(0,50,0,50),Position=UDim2.new(0.5,-25,0,20)}):Play(); task.wait(1.2) end end)
    local tl=Instance.new("TextLabel",card); tl.Size=UDim2.new(1,0,0,25); tl.Position=UDim2.new(0,0,0,78); tl.BackgroundTransparency=1; tl.Text="TEMPEST v3.2"; tl.TextColor3=Color3.fromRGB(240,240,240); tl.TextSize=18; tl.Font=Enum.Font.GothamBold
    local sl=Instance.new("TextLabel",card); sl.Size=UDim2.new(1,0,0,18); sl.Position=UDim2.new(0,0,0,105); sl.BackgroundTransparency=1; sl.Text="Enter your license key to continue"; sl.TextColor3=Color3.fromRGB(140,140,145); sl.TextSize=12; sl.Font=Enum.Font.Gotham
    local ic=Instance.new("Frame",card); ic.Size=UDim2.new(0,340,0,42); ic.Position=UDim2.new(0.5,-170,0,140); ic.BackgroundColor3=Color3.fromRGB(35,35,38); ic.BorderSizePixel=0; Instance.new("UICorner",ic).CornerRadius=UDim.new(0,8)
    local is=Instance.new("UIStroke",ic); is.Color=Color3.fromRGB(60,60,65); is.Thickness=1.5
    local ikl=Instance.new("TextLabel",ic); ikl.Size=UDim2.new(0,35,1,0); ikl.BackgroundTransparency=1; ikl.Text="ğŸ”‘"; ikl.TextSize=16; ikl.Font=Enum.Font.Gotham
    local ki=Instance.new("TextBox",ic); ki.Size=UDim2.new(1,-45,1,0); ki.Position=UDim2.new(0,38,0,0); ki.BackgroundTransparency=1; ki.Text=""; ki.PlaceholderText="Paste your key here..."; ki.PlaceholderColor3=Color3.fromRGB(90,90,95); ki.TextColor3=Color3.fromRGB(220,220,220); ki.TextSize=13; ki.Font=Enum.Font.Code; ki.ClearTextOnFocus=false; ki.TextXAlignment=Enum.TextXAlignment.Left
    ki.Focused:Connect(function() TweenService:Create(is,TweenInfo.new(0.2),{Color=Color3.fromRGB(0,122,204)}):Play() end)
    ki.FocusLost:Connect(function() TweenService:Create(is,TweenInfo.new(0.2),{Color=Color3.fromRGB(60,60,65)}):Play() end)
    local vb=Instance.new("TextButton",card); vb.Size=UDim2.new(0,340,0,40); vb.Position=UDim2.new(0.5,-170,0,195); vb.BackgroundColor3=Color3.fromRGB(0,122,204); vb.BorderSizePixel=0; vb.Text="VERIFY KEY"; vb.TextColor3=Color3.fromRGB(255,255,255); vb.TextSize=14; vb.Font=Enum.Font.GothamBold; Instance.new("UICorner",vb).CornerRadius=UDim.new(0,8)
    vb.MouseEnter:Connect(function() TweenService:Create(vb,TweenInfo.new(0.15),{BackgroundColor3=Color3.fromRGB(28,151,234)}):Play() end)
    vb.MouseLeave:Connect(function() TweenService:Create(vb,TweenInfo.new(0.15),{BackgroundColor3=Color3.fromRGB(0,122,204)}):Play() end)
    local stl=Instance.new("TextLabel",card); stl.Size=UDim2.new(1,0,0,18); stl.Position=UDim2.new(0,0,0,245); stl.BackgroundTransparency=1; stl.Text=""; stl.TextColor3=Color3.fromRGB(232,17,35); stl.TextSize=11; stl.Font=Enum.Font.GothamBold
    local ftl=Instance.new("TextLabel",card); ftl.Size=UDim2.new(1,0,0,16); ftl.Position=UDim2.new(0,0,1,-22); ftl.BackgroundTransparency=1; ftl.Text="tempest.dev Â· secure authentication"; ftl.TextColor3=Color3.fromRGB(70,70,75); ftl.TextSize=10; ftl.Font=Enum.Font.Gotham
    local vfying=false
    local function doVerify()
        if vfying then return end; vfying=true; vb.Text=""; local ld=0
        local lc=RunService.Heartbeat:Connect(function() ld=(ld+1)%40; vb.Text="VERIFYING"..string.rep("Â·",math.floor(ld/10)+1) end)
        TweenService:Create(vb,TweenInfo.new(0.2),{BackgroundColor3=Color3.fromRGB(80,80,90)}):Play(); task.wait(1.5); lc:Disconnect()
        if ki.Text==VALID_KEY then
            stl.Text="âœ“ KEY VERIFIED"; stl.TextColor3=Color3.fromRGB(0,200,100); vb.Text="âœ“ ACCESS GRANTED"
            TweenService:Create(vb,TweenInfo.new(0.3),{BackgroundColor3=Color3.fromRGB(0,200,100)}):Play()
            TweenService:Create(ab,TweenInfo.new(0.3),{BackgroundColor3=Color3.fromRGB(0,200,100)}):Play()
            task.wait(0.5)
            TweenService:Create(card,TweenInfo.new(0.4,Enum.EasingStyle.Back,Enum.EasingDirection.In),{BackgroundTransparency=1}):Play()
            TweenService:Create(cs,TweenInfo.new(0.4),{BackgroundTransparency=1}):Play()
            TweenService:Create(overlay,TweenInfo.new(0.5),{BackgroundTransparency=1}):Play()
            task.wait(0.6); keyVerified=true; keyGui:Destroy()
        else
            stl.Text="âœ— INVALID KEY"; stl.TextColor3=Color3.fromRGB(232,17,35); vb.Text="VERIFY KEY"
            TweenService:Create(vb,TweenInfo.new(0.2),{BackgroundColor3=Color3.fromRGB(232,17,35)}):Play()
            TweenService:Create(is,TweenInfo.new(0.2),{Color=Color3.fromRGB(232,17,35)}):Play()
            for _=1,3 do TweenService:Create(card,TweenInfo.new(0.04),{Position=ctp+UDim2.new(0,8,0,0)}):Play(); task.wait(0.04); TweenService:Create(card,TweenInfo.new(0.04),{Position=ctp+UDim2.new(0,-8,0,0)}):Play(); task.wait(0.04) end
            TweenService:Create(card,TweenInfo.new(0.06),{Position=ctp}):Play()
            task.wait(0.8); TweenService:Create(vb,TweenInfo.new(0.3),{BackgroundColor3=Color3.fromRGB(0,122,204)}):Play()
            TweenService:Create(is,TweenInfo.new(0.3),{Color=Color3.fromRGB(60,60,65)}):Play(); stl.Text=""; vfying=false
        end
    end
    vb.MouseButton1Click:Connect(doVerify); ki.FocusLost:Connect(function(e) if e then doVerify() end end)
    while not keyVerified do task.wait(0.1) end
end
runKeySystem()

--------------------------------------------------------------
-- ANTI-KICK PROTECTION
--------------------------------------------------------------
local suppressedKicks = 0
local suppressedErrors = 0

local kickPatterns = {
    "not available","g not available","error trying to set",
    "cheat","exploit","hack","kick","ban","violation",
    "detected","suspicious","illegal","unauthorized",
    "tamper","integrity","modified","inject","speed",
    "teleport","fly","noclip","invalid","mismatch",
    "anticheat","anti-cheat","anti cheat","ac_",
    "security","verification failed","check failed",
    "unexpected","abnormal","forbidden",
    "value","limit","exceeded","out of range","too high",
    "too low","overflow","underflow","boundary","cap",
    "throttle","rate limit","too fast","too many",
    "sanity","validate","constraint","restrict",
    "magnitude","walkspeed","jumppower","health",
}

local function matchesKickPattern(str)
    local lower = str:lower()
    for _, pattern in ipairs(kickPatterns) do
        if lower:find(pattern, 1, true) then return true end
    end
    return false
end

pcall(function() player.Kick = function(self, reason) suppressedKicks=suppressedKicks+1; warn("[Tempest - ANTI-KICK] Blocked kick #"..suppressedKicks..": "..tostring(reason)) end end)
pcall(function() if hookfunction then hookfunction(game.Players.LocalPlayer.Kick, function(self, reason) suppressedKicks=suppressedKicks+1 end) end end)

pcall(function()
    local mt = getrawmetatable(game)
    if mt and setreadonly then
        setreadonly(mt, false)
        local oldNamecall = mt.__namecall
        mt.__namecall = newcclosure(function(self, ...)
            local method = getnamecallmethod()
            if self == player and (method == "Kick" or method == "Destroy") then suppressedKicks=suppressedKicks+1; return end
            if (method == "FireServer" or method == "InvokeServer") and self and self.Name then
                local rn = self.Name:lower()
                for _, w in ipairs({"kick","ban","punish","cheat","exploit","violation","report","flag","detect"}) do
                    if rn:find(w, 1, true) then suppressedKicks=suppressedKicks+1; return end
                end
                local args = {...}
                if args[1] and type(args[1]) == "string" then
                    local al = args[1]:lower()
                    for _, w in ipairs({"kick","ban","cheat","exploit","violation","flag"}) do
                        if al:find(w, 1, true) then suppressedKicks=suppressedKicks+1; return end
                    end
                end
            end
            local ok, result = pcall(oldNamecall, self, ...)
            if not ok then
                if matchesKickPattern(tostring(result)) then suppressedErrors=suppressedErrors+1; return nil end
                error(result)
            end
            return result
        end)
        setreadonly(mt, true)
    end
end)

pcall(function()
    local mt = getrawmetatable(game)
    if mt and setreadonly then
        setreadonly(mt, false)
        local oldIndex = mt.__index
        mt.__index = newcclosure(function(self, key)
            local ok, res = pcall(function() return oldIndex(self, key) end)
            if not ok then if matchesKickPattern(tostring(res)) then suppressedErrors=suppressedErrors+1; return nil end; error(res) end
            return res
        end)
        setreadonly(mt, true)
    end
end)

pcall(function()
    local mt = getrawmetatable(game)
    if mt and setreadonly then
        setreadonly(mt, false)
        local oldNewIndex = mt.__newindex
        mt.__newindex = newcclosure(function(self, key, value)
            local ok, res = pcall(function() return oldNewIndex(self, key, value) end)
            if not ok then if matchesKickPattern(tostring(res)) then suppressedErrors=suppressedErrors+1; return end; error(res) end
        end)
        setreadonly(mt, true)
    end
end)

pcall(function() ScriptContext.Error:Connect(function(msg) if matchesKickPattern(msg) then suppressedErrors=suppressedErrors+1 end end) end)

--------------------------------------------------------------
-- SAFE CALL & PROPERTY HELPERS (defined early - used everywhere below)
--------------------------------------------------------------
local function safeCall(func, ctx)
    local ok, res = pcall(func)
    if not ok then
        if matchesKickPattern(tostring(res)) then suppressedErrors=suppressedErrors+1; return false, nil end
        warn("[Tempest] "..(ctx or "op")..": "..tostring(res))
    end
    return ok, res
end

local function clampNum(v, lo, hi)
    v = tonumber(v) or 0; if v~=v then v=0 end; if v==math.huge or v==-math.huge then v=0 end
    return math.clamp(v, lo or -1e6, hi or 1e6)
end

local function safeProp(obj, prop, val)
    return safeCall(function()
        if type(val)=="number" then
            if prop=="MaxDistance" then val=clampNum(val,0,1e5) elseif prop=="TextSize" then val=clampNum(val,1,200)
            elseif prop:find("Size") or prop:find("Offset") then val=clampNum(val,-1e4,1e4) else val=clampNum(val) end
        end
        obj[prop] = val
    end, "Set "..prop)
end

--------------------------------------------------------------
-- SCRIPT NEUTRALIZATION ENGINE
--------------------------------------------------------------
local neutralizedScripts = 0
local dangerousScriptPatterns = {
    "anticheat","anti_cheat","anti-cheat","ac_","cheatdetect",
    "kickdetect","kickscript","exploit","guard","sentinel",
    "watchdog","monitor","integrity","validation","verify",
    "security","protection","shield","defender","patrol",
    "checker","detector","scanner","enforcer",
    "valuelimit","value_limit","ratelimit","rate_limit",
    "speedcheck","positioncheck","healthcheck",
}
local dangerousSourcePatterns = {
    ":kick(",":Kick(","player:Kick","Player:Kick",
    "Kick(player","kick(player",":Destroy()",
    "not available","g not available",
    "FireServer.*kick","FireServer.*ban",
    "exceeded","out of range","too high","value limit",
    "magnitude","sanity check",
}

local function isScriptDangerous(scriptObj)
    local nameLower = scriptObj.Name:lower(); local pathLower = scriptObj:GetFullName():lower()
    for _, pattern in ipairs(dangerousScriptPatterns) do if nameLower:find(pattern,1,true) or pathLower:find(pattern,1,true) then return true, "name: "..pattern end end
    local sourceOk, source = pcall(function() if decompile then return decompile(scriptObj) end; return nil end)
    if sourceOk and source then local sl=source:lower(); for _,pattern in ipairs(dangerousSourcePatterns) do if sl:find(pattern:lower(),1,true) then return true, "source: "..pattern end end end
    return false, nil
end

local function neutralizeScript(scriptObj)
    local success=false
    pcall(function() scriptObj.Disabled=true; success=true end); pcall(function() scriptObj:Destroy(); success=true end)
    pcall(function() scriptObj.Source=""; success=true end); pcall(function() scriptObj.Parent=nil; success=true end)
    if success then neutralizedScripts=neutralizedScripts+1 end; return success
end

local function scanAndNeutralizeScripts()
    local checked, neutralized = 0, 0
    local function processContainer(container) pcall(function() for _,obj in ipairs(container:GetDescendants()) do pcall(function()
        if obj:IsA("LocalScript") or obj:IsA("ModuleScript") then checked=checked+1; local dangerous,reason=isScriptDangerous(obj); if dangerous then if neutralizeScript(obj) then neutralized=neutralized+1; warn("[Tempest - NEUTRALIZE] Killed: "..obj:GetFullName().." ("..tostring(reason)..")") end end end
    end) end end) end
    local containers={playerGui,ReplicatedStorage,ReplicatedFirst,Lighting,StarterGui,workspace,game:GetService("StarterPack"),game:GetService("StarterPlayer")}
    pcall(function() table.insert(containers, player:FindFirstChild("Backpack")) end)
    pcall(function() table.insert(containers, player:FindFirstChild("PlayerScripts")) end)
    pcall(function() table.insert(containers, player) end)
    pcall(function() if character then table.insert(containers, character) end end)
    pcall(function() for _,obj in ipairs(CoreGui:GetDescendants()) do pcall(function() if obj:IsA("LocalScript") or obj:IsA("ModuleScript") then checked=checked+1; local d,r=isScriptDangerous(obj); if d then neutralizeScript(obj); neutralized=neutralized+1 end end end) end end)
    for _,container in ipairs(containers) do if container then processContainer(container) end end
    return checked, neutralized
end

--------------------------------------------------------------
-- REMOTE EVENT INTERCEPTION
--------------------------------------------------------------
local blockedRemotes = {}
local function interceptKickRemotes()
    local blocked = 0
    local bw = {"kick","ban","punish","remove","cheat","exploit","violation","report","flag","detect","limit","sanity"}
    local function checkRemote(remote) pcall(function()
        local nl=remote.Name:lower()
        for _,p in ipairs(bw) do if nl:find(p,1,true) then pcall(function()
            if remote:IsA("RemoteEvent") then remote.FireServer=function() blocked=blocked+1 end
            elseif remote:IsA("RemoteFunction") then remote.InvokeServer=function() blocked=blocked+1; return nil end end
            blockedRemotes[remote]=true
        end); break end end
    end) end
    pcall(function() for _,obj in ipairs(game:GetDescendants()) do pcall(function() if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") then checkRemote(obj) end end) end end)
    pcall(function() game.DescendantAdded:Connect(function(obj) pcall(function() if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") then checkRemote(obj) end end) end) end)
    return blocked
end

--------------------------------------------------------------
-- NOTIFICATION SYSTEM & CHAT BUBBLE FILTER
--------------------------------------------------------------
local isScanActive = false
local billboardNotifsSuppressed = 0
local MAX_VISIBLE_NOTIFS = 5
local activeNotifCount = 0

local ignoredBBPatterns = {"bubble","chat","chatbubble","chat_bubble","chatframe","speechbubble","speech","dialogue","dialog","bubblechat","textchat","chatgui","chatbillboard"}
local function isChatBubble(bb)
    local nl=bb.Name:lower(); for _,p in ipairs(ignoredBBPatterns) do if nl:find(p,1,true) then return true end end
    local pl=bb:GetFullName():lower(); if pl:find("bubblechat") or pl:find("chatbubble") or pl:find("textchatservice") then return true end
    return false
end

--------------------------------------------------------------
-- BILLBOARD DATABASE
--------------------------------------------------------------
local DB = {
    remoteEvents={},remoteFunctions={},bindableEvents={},bindableFunctions={},
    textBoxes={},textButtons={},imageButtons={},
    stringValues={},intValues={},numberValues={},boolValues={},objectValues={},
    attributes={},tags={},
    moduleScripts={},localScripts={},serverScripts={},folders={},allGuis={},
    remotesByName={},remotesByParent={},successfulRemotes={},
    snapshots={},lastScanTime=0,scanCount=0,
    billboardKeywords={"billboard","bill","board","overhead","nametag","name_tag","label","display","sign","gui","hud","indicator","marker","title","tag","plate","banner","header","status","info","rank","level","health","hp","bar","text","floating","hover","popup","tooltip","badge","icon","notification","alert","announce","message","msg"},
    updateKeywords={"update","set","change","modify","edit","alter","replace","write","send","post","submit","apply","save","put","refresh","reload","sync","push","fire","trigger","emit","broadcast","dispatch","invoke","call","request","handle","process","create","make","build","render","draw","show","hide","toggle","enable","disable","activate","deactivate","remove","delete","destroy","clear","reset","init","configure","customize","personalize","assign","attach"},
    textKeywords={"text","string","content","message","msg","name","title","label","caption","description","desc","value","data","info","detail","input","output","display","word","letter","char","write","read","note"},
}

--------------------------------------------------------------
-- GAME SCANNER
--------------------------------------------------------------
local SCAN_BATCH = 300
local ANALYZE_BATCH = 5

local function deepScanGame()
    DB.remoteEvents={};DB.remoteFunctions={};DB.bindableEvents={};DB.bindableFunctions={}
    DB.textBoxes={};DB.textButtons={};DB.imageButtons={}
    DB.stringValues={};DB.intValues={};DB.numberValues={};DB.boolValues={};DB.objectValues={}
    DB.attributes={};DB.tags={}
    DB.moduleScripts={};DB.localScripts={};DB.serverScripts={};DB.folders={};DB.allGuis={}
    DB.remotesByName={};DB.remotesByParent={}
    local containers={ReplicatedStorage,workspace,Lighting,ReplicatedFirst,StarterGui,game:GetService("StarterPack"),game:GetService("StarterPlayer"),player,playerGui}
    safeCall(function() local bp=player:FindFirstChild("Backpack"); if bp then table.insert(containers,bp) end end)
    if character then table.insert(containers, character) end
    local scanned = 0
    for _,root in ipairs(containers) do
        local ok,descendants=pcall(function() return root:GetDescendants() end); if not ok then continue end
        for i,obj in ipairs(descendants) do
            if i%SCAN_BATCH==0 then task.wait() end
            safeCall(function()
                scanned=scanned+1; local cn=obj.ClassName
                if cn=="RemoteEvent" then table.insert(DB.remoteEvents,obj); local nl=obj.Name:lower(); DB.remotesByName[nl]=DB.remotesByName[nl] or {}; table.insert(DB.remotesByName[nl],obj); local pn=obj.Parent and obj.Parent:GetFullName() or ""; DB.remotesByParent[pn]=DB.remotesByParent[pn] or {}; table.insert(DB.remotesByParent[pn],obj)
                elseif cn=="RemoteFunction" then table.insert(DB.remoteFunctions,obj); local nl=obj.Name:lower(); DB.remotesByName[nl]=DB.remotesByName[nl] or {}; table.insert(DB.remotesByName[nl],obj)
                elseif cn=="BindableEvent" then table.insert(DB.bindableEvents,obj)
                elseif cn=="BindableFunction" then table.insert(DB.bindableFunctions,obj)
                elseif cn=="TextBox" then table.insert(DB.textBoxes,obj)
                elseif cn=="TextButton" then table.insert(DB.textButtons,obj)
                elseif cn=="ImageButton" then table.insert(DB.imageButtons,obj)
                elseif cn=="StringValue" then table.insert(DB.stringValues,obj)
                elseif cn=="IntValue" then table.insert(DB.intValues,obj)
                elseif cn=="NumberValue" then table.insert(DB.numberValues,obj)
                elseif cn=="BoolValue" then table.insert(DB.boolValues,obj)
                elseif cn=="ObjectValue" then table.insert(DB.objectValues,obj)
                elseif cn=="ModuleScript" then table.insert(DB.moduleScripts,obj)
                elseif cn=="LocalScript" then table.insert(DB.localScripts,obj)
                elseif cn=="Script" then table.insert(DB.serverScripts,obj)
                elseif cn=="Folder" then table.insert(DB.folders,obj)
                elseif cn=="BillboardGui" or cn=="ScreenGui" or cn=="SurfaceGui" then table.insert(DB.allGuis,obj) end
                if cn=="BillboardGui" then
                    safeCall(function() for name,val in pairs(obj:GetAttributes()) do table.insert(DB.attributes,{instance=obj,name=name,value=val}) end end)
                    safeCall(function() for _,tag in ipairs(CollectionService:GetTags(obj)) do table.insert(DB.tags,{instance=obj,tag=tag}) end end)
                end
            end)
        end
        task.wait()
    end
    DB.lastScanTime=os.clock(); DB.scanCount=scanned; return scanned
end

--------------------------------------------------------------
-- KEYWORD MATCHING & RELEVANCE
--------------------------------------------------------------
local function matchScore(name, keywords)
    local n=name:lower(); local score=0
    for _,kw in ipairs(keywords) do if n==kw then score=score+100 elseif n:find(kw,1,true) then score=score+50+(#kw/#n)*30 end end
    return score
end

local function computeRemoteRelevance(remote, billboard)
    local score=0; local rName,bName=remote.Name:lower(),billboard.Name:lower()
    local bParentName=(billboard.Parent and billboard.Parent.Name or ""):lower()
    if rName:find(bName,1,true) or bName:find(rName,1,true) then score=score+80 end
    if rName:find(bParentName,1,true) or bParentName:find(rName,1,true) then score=score+40 end
    score=score+matchScore(rName,DB.billboardKeywords)*0.6+matchScore(rName,DB.updateKeywords)*0.4+matchScore(rName,DB.textKeywords)*0.3
    local rPath,bPath=remote:GetFullName(),billboard:GetFullName(); local cp=0
    for i=1,math.min(#rPath,#bPath) do if rPath:sub(i,i)==bPath:sub(i,i) then cp=cp+1 else break end end
    score=score+(cp/math.max(#rPath,1))*40
    if remote.Parent==billboard.Parent then score=score+60 end
    if remote.Parent and billboard.Parent and remote.Parent.Parent==billboard.Parent.Parent then score=score+30 end
    if DB.successfulRemotes[remote] then score=score+200 end
    return math.min(score,500)
end

--------------------------------------------------------------
-- ULTRA DEEP ANALYSIS ENGINE
--------------------------------------------------------------
local analysisCache = {}

local function isPlayerOwned(bb)
    local cur=bb.Parent; while cur do
        if cur==character or cur==player then return true end
        if cur:IsA("Backpack") and cur.Parent==player then return true end
        cur=cur.Parent
    end; return false
end

local function ultraAnalyze(billboard)
    if not billboard or not billboard.Parent then return nil end
    local a={billboard=billboard,isPlayerOwned=isPlayerOwned(billboard),rankedRemotes={},guiMethods={textBoxes={},submitButtons={},applyButtons={},toggleButtons={}},valueObjects={strings={},ints={},numbers={},bools={},objects={}},attributeControls={},tagControls={},scripts={server={},local_={},modules={}},bindables={events={},functions={}},confidence=0,hasServerControl=false,argPatterns={},hierarchy={}}
    local cur=billboard; while cur and cur~=game do table.insert(a.hierarchy,cur); cur=cur.Parent end
    for _,remote in ipairs(DB.remoteEvents) do local sc=computeRemoteRelevance(remote,billboard); if sc>5 then table.insert(a.rankedRemotes,{remote=remote,score=sc,type="RemoteEvent",path=remote:GetFullName()}) end end
    for _,remote in ipairs(DB.remoteFunctions) do local sc=computeRemoteRelevance(remote,billboard); if sc>5 then table.insert(a.rankedRemotes,{remote=remote,score=sc,type="RemoteFunction",path=remote:GetFullName()}) end end
    table.sort(a.rankedRemotes,function(x,y) return x.score>y.score end)
    local searchRoots={billboard}; if billboard.Parent then table.insert(searchRoots,billboard.Parent) end
    for _,gui in ipairs(playerGui:GetChildren()) do if gui:IsA("ScreenGui") then table.insert(searchRoots,gui) end end
    local foundTB,foundBT={},{}
    for _,root in ipairs(searchRoots) do safeCall(function() for _,desc in ipairs(root:GetDescendants()) do safeCall(function()
        if desc:IsA("TextBox") then local sc=matchScore(desc.Name:lower(),DB.textKeywords)+matchScore(desc.Name:lower(),DB.updateKeywords); if desc:IsDescendantOf(billboard) then sc=sc+100 end; if billboard.Parent and desc:IsDescendantOf(billboard.Parent) then sc=sc+50 end; safeCall(function() sc=sc+matchScore(desc.PlaceholderText:lower(),DB.billboardKeywords)+matchScore(desc.PlaceholderText:lower(),DB.textKeywords) end); table.insert(foundTB,{obj=desc,score=sc})
        elseif desc:IsA("TextButton") or desc:IsA("ImageButton") then local sc=matchScore(desc.Name:lower(),DB.updateKeywords)+matchScore(desc.Name:lower(),DB.billboardKeywords); if desc:IsA("TextButton") then sc=sc+matchScore(desc.Text:lower(),DB.updateKeywords) end; if desc:IsDescendantOf(billboard) then sc=sc+80 end; if billboard.Parent and desc:IsDescendantOf(billboard.Parent) then sc=sc+30 end; table.insert(foundBT,{obj=desc,score=sc}) end
    end) end end) end
    table.sort(foundTB,function(x,y) return x.score>y.score end); table.sort(foundBT,function(x,y) return x.score>y.score end)
    for i,tb in ipairs(foundTB) do if i>20 then break end; table.insert(a.guiMethods.textBoxes,tb) end
    for _,btn in ipairs(foundBT) do local bn,bt=btn.obj.Name:lower(),btn.obj:IsA("TextButton") and btn.obj.Text:lower() or ""
        if matchScore(bn,{"apply","save","submit","send","update","confirm","ok","done","set"})>0 or matchScore(bt,{"apply","save","submit","send","update","confirm","ok","done","set"})>0 then table.insert(a.guiMethods.submitButtons,btn)
        elseif matchScore(bn,{"toggle","switch","enable","disable","show","hide","on","off"})>0 or matchScore(bt,{"toggle","switch","enable","disable","show","hide","on","off"})>0 then table.insert(a.guiMethods.toggleButtons,btn)
        else table.insert(a.guiMethods.applyButtons,btn) end
    end
    for _,sv in ipairs(DB.stringValues) do safeCall(function() local sc=matchScore(sv.Name:lower(),DB.billboardKeywords)+matchScore(sv.Name:lower(),DB.textKeywords); for _,anc in ipairs(a.hierarchy) do if sv:IsDescendantOf(anc) then sc=sc+60; break end end; for _,desc in ipairs(billboard:GetDescendants()) do if (desc:IsA("TextLabel") or desc:IsA("TextBox") or desc:IsA("TextButton")) and desc.Text==sv.Value then sc=sc+120 end end; if sc>10 then table.insert(a.valueObjects.strings,{obj=sv,score=sc,value=sv.Value}) end end) end
    for _,iv in ipairs(DB.intValues) do safeCall(function() local sc=matchScore(iv.Name:lower(),DB.billboardKeywords); for _,anc in ipairs(a.hierarchy) do if iv:IsDescendantOf(anc) then sc=sc+40; break end end; if sc>10 then table.insert(a.valueObjects.ints,{obj=iv,score=sc,value=iv.Value}) end end) end
    for _,nv in ipairs(DB.numberValues) do safeCall(function() local sc=matchScore(nv.Name:lower(),DB.billboardKeywords); for _,anc in ipairs(a.hierarchy) do if nv:IsDescendantOf(anc) then sc=sc+40; break end end; if sc>10 then table.insert(a.valueObjects.numbers,{obj=nv,score=sc,value=nv.Value}) end end) end
    for _,bv in ipairs(DB.boolValues) do safeCall(function() local sc=matchScore(bv.Name:lower(),DB.billboardKeywords); for _,anc in ipairs(a.hierarchy) do if bv:IsDescendantOf(anc) then sc=sc+40; break end end; if sc>10 then table.insert(a.valueObjects.bools,{obj=bv,score=sc,value=bv.Value}) end end) end
    for _,attr in ipairs(DB.attributes) do safeCall(function() local sc=matchScore(attr.name:lower(),DB.billboardKeywords)+matchScore(attr.name:lower(),DB.textKeywords); for _,anc in ipairs(a.hierarchy) do if attr.instance==anc then sc=sc+80; break elseif attr.instance:IsDescendantOf(anc) then sc=sc+40; break end end; if sc>10 then table.insert(a.attributeControls,{instance=attr.instance,name=attr.name,value=attr.value,score=sc}) end end) end
    for _,tg in ipairs(DB.tags) do safeCall(function() local sc=matchScore(tg.tag:lower(),DB.billboardKeywords); if tg.instance==billboard then sc=sc+100 end; for _,anc in ipairs(a.hierarchy) do if tg.instance:IsDescendantOf(anc) then sc=sc+30; break end end; if sc>10 then table.insert(a.tagControls,{instance=tg.instance,tag=tg.tag,score=sc}) end end) end
    for _,anc in ipairs(a.hierarchy) do safeCall(function() for _,desc in ipairs(anc:GetDescendants()) do safeCall(function()
        if desc:IsA("Script") then table.insert(a.scripts.server,{script=desc,path=desc:GetFullName()})
        elseif desc:IsA("LocalScript") then table.insert(a.scripts.local_,{script=desc,path=desc:GetFullName()})
        elseif desc:IsA("ModuleScript") then table.insert(a.scripts.modules,{script=desc,path=desc:GetFullName()}) end
    end) end end) end
    for _,be in ipairs(DB.bindableEvents) do safeCall(function() local sc=matchScore(be.Name:lower(),DB.billboardKeywords)+matchScore(be.Name:lower(),DB.updateKeywords); for _,anc in ipairs(a.hierarchy) do if be:IsDescendantOf(anc) then sc=sc+50; break end end; if sc>10 then table.insert(a.bindables.events,{obj=be,score=sc}) end end) end
    for _,bf in ipairs(DB.bindableFunctions) do safeCall(function() local sc=matchScore(bf.Name:lower(),DB.billboardKeywords)+matchScore(bf.Name:lower(),DB.updateKeywords); for _,anc in ipairs(a.hierarchy) do if bf:IsDescendantOf(anc) then sc=sc+50; break end end; if sc>10 then table.insert(a.bindables.functions,{obj=bf,score=sc}) end end) end
    local bName,bParent,bPath=billboard.Name,billboard.Parent and billboard.Parent.Name or "",billboard:GetFullName()
    a.argPatterns={
        function(p,v) return "UpdateBillboard",billboard,p,v end, function(p,v) return "SetBillboard",billboard,p,v end,
        function(p,v) return "ChangeBillboard",billboard,p,v end, function(p,v) return "EditBillboard",billboard,p,v end,
        function(p,v) return billboard,p,v end, function(p,v) return p,v end,
        function(p,v) return {Billboard=billboard,Property=p,Value=v} end,
        function(p,v) return {billboard=billboard,property=p,value=v} end,
        function(p,v) return {Target=billboard,Key=p,Value=v} end,
        function(p,v) return {target=billboard,key=p,value=v} end,
        function(p,v) return {Name=bName,Property=p,Value=v} end,
        function(p,v) return {name=bName,property=p,value=v} end,
        function(p,v) return bName,p,v end, function(p,v) return bParent,bName,p,v end,
        function(p,v) return bPath,p,v end, function(p,v) return player,billboard,p,v end,
        function(p,v) return v end, function(p,v) return bName,v end,
        function(p,v) return billboard,{[p]=v} end, function(p,v) return {billboard,p,v} end,
    }
    local conf=0
    if #a.rankedRemotes>0 then conf=conf+math.min(a.rankedRemotes[1].score,100) end
    if #a.guiMethods.textBoxes>0 then conf=conf+15 end; if #a.guiMethods.submitButtons>0 then conf=conf+20 end
    if #a.valueObjects.strings>0 then conf=conf+25 end; if #a.attributeControls>0 then conf=conf+15 end
    if #a.scripts.server>0 then conf=conf+20 end; if #a.bindables.events>0 then conf=conf+10 end
    a.confidence=math.min(conf,100); a.hasServerControl=conf>15 or #a.rankedRemotes>0 or #a.scripts.server>0
    analysisCache[billboard]=a; return a
end

--------------------------------------------------------------
-- SERVER-SIDE CHANGE ENGINE
--------------------------------------------------------------
local function attemptServerChange(billboard,prop,val,analysis)
    if type(val)=="number" then if prop=="MaxDistance" then val=clampNum(val,0,1e5) elseif prop=="TextSize" then val=clampNum(val,1,200) elseif prop:find("Size") or prop:find("Offset") then val=clampNum(val,-1e4,1e4) else val=clampNum(val) end end
    analysis=analysis or analysisCache[billboard]; if not analysis then safeProp(billboard,prop,val); return false,0 end
    local attempted=0
    for i,entry in ipairs(analysis.rankedRemotes) do if attempted>=8 then break end; if blockedRemotes[entry.remote] then continue end
        if entry.remote:IsA("RemoteEvent") then for _,pat in ipairs(analysis.argPatterns) do safeCall(function() entry.remote:FireServer(pat(prop,val)) end) end; attempted=attempted+1
        elseif entry.remote:IsA("RemoteFunction") then for j,pat in ipairs(analysis.argPatterns) do if j>6 then break end; safeCall(function() entry.remote:InvokeServer(pat(prop,val)) end) end; attempted=attempted+1 end
    end
    if prop=="Text" and type(val)=="string" then for _,sv in ipairs(analysis.valueObjects.strings) do safeCall(function() sv.obj.Value=val end) end
    elseif type(val)=="number" then for _,nv in ipairs(analysis.valueObjects.numbers) do safeCall(function() nv.obj.Value=val end) end; for _,iv in ipairs(analysis.valueObjects.ints) do safeCall(function() iv.obj.Value=math.floor(val) end) end
    elseif type(val)=="boolean" then for _,bv in ipairs(analysis.valueObjects.bools) do safeCall(function() bv.obj.Value=val end) end end
    for _,ac in ipairs(analysis.attributeControls) do safeCall(function() if ac.name:lower():find(prop:lower()) then ac.instance:SetAttribute(ac.name,val) end end) end
    for _,be in ipairs(analysis.bindables.events) do safeCall(function() be.obj:Fire(billboard,prop,val) end); safeCall(function() be.obj:Fire(prop,val) end) end
    if prop=="Text" and type(val)=="string" then for _,tb in ipairs(analysis.guiMethods.textBoxes) do safeCall(function() tb.obj.Text=val; tb.obj:ReleaseFocus(true) end) end end
    safeProp(billboard,prop,val); return attempted>0, attempted
end

local function attemptServerTextChange(textElement,newText,billboard,analysis)
    if type(newText)~="string" then newText=tostring(newText) end; analysis=analysis or analysisCache[billboard]; local attempted=0
    if analysis then
        for i,entry in ipairs(analysis.rankedRemotes) do if attempted>=8 then break end; if blockedRemotes[entry.remote] then continue end
            if entry.remote:IsA("RemoteEvent") then
                safeCall(function() entry.remote:FireServer("UpdateText",billboard,textElement,newText) end)
                safeCall(function() entry.remote:FireServer("SetText",textElement,newText) end)
                safeCall(function() entry.remote:FireServer(billboard,"Text",newText) end)
                safeCall(function() entry.remote:FireServer({Billboard=billboard,TextElement=textElement,Text=newText}) end)
                safeCall(function() entry.remote:FireServer({target=billboard,text=newText}) end)
                safeCall(function() entry.remote:FireServer(textElement.Name,newText) end)
                safeCall(function() entry.remote:FireServer(billboard.Name,textElement.Name,newText) end)
                safeCall(function() entry.remote:FireServer(newText) end)
                safeCall(function() entry.remote:FireServer(player,billboard,newText) end)
                safeCall(function() entry.remote:FireServer("Text",newText) end); attempted=attempted+1
            elseif entry.remote:IsA("RemoteFunction") then
                safeCall(function() entry.remote:InvokeServer("UpdateText",billboard,textElement,newText) end)
                safeCall(function() entry.remote:InvokeServer(billboard,"Text",newText) end)
                safeCall(function() entry.remote:InvokeServer({Billboard=billboard,Text=newText}) end); attempted=attempted+1
            end
        end
        for _,sv in ipairs(analysis.valueObjects.strings) do safeCall(function() sv.obj.Value=newText end) end
        for _,ac in ipairs(analysis.attributeControls) do safeCall(function() if type(ac.value)=="string" then ac.instance:SetAttribute(ac.name,newText) end end) end
        for _,be in ipairs(analysis.bindables.events) do safeCall(function() be.obj:Fire(billboard,"Text",newText) end); safeCall(function() be.obj:Fire(textElement,newText) end) end
        for _,tb in ipairs(analysis.guiMethods.textBoxes) do safeCall(function() tb.obj.Text=newText; tb.obj:ReleaseFocus(true) end) end
    end
    safeProp(textElement,"Text",newText); return attempted>0, attempted
end

local function snapshotBillboard(bb) local snap={time=os.clock(),enabled=bb.Enabled,alwaysOnTop=bb.AlwaysOnTop,maxDistance=bb.MaxDistance,texts={},childCount=#bb:GetChildren()}; for _,d in ipairs(bb:GetDescendants()) do if d:IsA("TextLabel") or d:IsA("TextBox") or d:IsA("TextButton") then table.insert(snap.texts,{name=d.Name,text=d.Text,size=d.TextSize}) end end; DB.snapshots[bb]=snap; return snap end

local function detectChanges(bb) local old=DB.snapshots[bb]; if not old then return {} end; local changes={}; safeCall(function() if bb.Enabled~=old.enabled then table.insert(changes,"Enabled: "..tostring(old.enabled).." â†’ "..tostring(bb.Enabled)) end; if bb.MaxDistance~=old.maxDistance then table.insert(changes,"MaxDistance: "..old.maxDistance.." â†’ "..bb.MaxDistance) end; if bb.AlwaysOnTop~=old.alwaysOnTop then table.insert(changes,"AlwaysOnTop: "..tostring(old.alwaysOnTop).." â†’ "..tostring(bb.AlwaysOnTop)) end; for _,d in ipairs(bb:GetDescendants()) do if d:IsA("TextLabel") or d:IsA("TextBox") or d:IsA("TextButton") then for _,ot in ipairs(old.texts) do if ot.name==d.Name and ot.text~=d.Text then table.insert(changes,d.Name..' Text: "'..ot.text..'" â†’ "'..d.Text..'"') end end end end end); return changes end

local activeWatchers = {}
local function watchBillboard(bb,onChange)
    if activeWatchers[bb] then for _,c in ipairs(activeWatchers[bb]) do safeCall(function() c:Disconnect() end) end end; activeWatchers[bb]={}
    for _,prop in ipairs({"Enabled","AlwaysOnTop","MaxDistance","Size","StudsOffset","Active","Adornee","LightInfluence","ClipsDescendants"}) do safeCall(function() table.insert(activeWatchers[bb],bb:GetPropertyChangedSignal(prop):Connect(function() safeCall(function() onChange(prop,bb[prop]) end) end)) end) end
    for _,d in ipairs(bb:GetDescendants()) do if d:IsA("TextLabel") or d:IsA("TextBox") or d:IsA("TextButton") then safeCall(function() table.insert(activeWatchers[bb],d:GetPropertyChangedSignal("Text"):Connect(function() safeCall(function() onChange("Text:"..d.Name,d.Text) end) end)) end) end end
    safeCall(function() table.insert(activeWatchers[bb],bb.DescendantAdded:Connect(function(d) safeCall(function() onChange("DescendantAdded",d.Name.." ("..d.ClassName..")") end) end)) end)
    safeCall(function() table.insert(activeWatchers[bb],bb.AttributeChanged:Connect(function(attr) safeCall(function() onChange("Attribute:"..attr,bb:GetAttribute(attr)) end) end)) end)
end

--------------------------------------------------------------
-- COMBAT TOOLS
--------------------------------------------------------------
local spectatingPlayer=nil; local startPosition=nil; local isTeleporting=false; local originalCameraSubject=Camera.CameraSubject
local isFlying=false; local flyConnection=nil; local flySpeed=65; local isAirball=false; local airballConnection=nil
local autoTpEnabled=false; local autoTpTarget=nil

local function stopFlying() if flyConnection then flyConnection:Disconnect(); flyConnection=nil end; isFlying=false; local char=player.Character; if char then local hrp=char:FindFirstChild("HumanoidRootPart"); if hrp then for _,v in pairs(hrp:GetChildren()) do if v:IsA("BodyVelocity") or v:IsA("BodyGyro") then v:Destroy() end end end end end
local function startFlying() if isFlying then return end; local char=player.Character; if not char then return end; local hrp=char:FindFirstChild("HumanoidRootPart"); if not hrp then return end; isFlying=true; local bv=Instance.new("BodyVelocity"); bv.MaxForce=Vector3.new(1e5,1e5,1e5); bv.Velocity=Vector3.new(0,0,0); bv.Parent=hrp; local bg=Instance.new("BodyGyro"); bg.MaxTorque=Vector3.new(1e5,1e5,1e5); bg.P=10000; bg.Parent=hrp
    flyConnection=RunService.Heartbeat:Connect(function() if not isFlying or not char.Parent or not hrp.Parent then stopFlying(); return end; local cam=workspace.CurrentCamera; local dir=Vector3.new(0,0,0)
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then dir=dir+cam.CFrame.LookVector end; if UserInputService:IsKeyDown(Enum.KeyCode.S) then dir=dir-cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then dir=dir-cam.CFrame.RightVector end; if UserInputService:IsKeyDown(Enum.KeyCode.D) then dir=dir+cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then dir=dir+Vector3.new(0,1,0) end; if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then dir=dir-Vector3.new(0,1,0) end
        if dir.Magnitude>0 then dir=dir.Unit end; if bv and bv.Parent then bv.Velocity=dir*flySpeed end; if bg and bg.Parent then bg.CFrame=cam.CFrame end
    end) end
local function stopAirball() if airballConnection then airballConnection:Disconnect(); airballConnection=nil end; isAirball=false; if startPosition then local char=player.Character; if char and char:FindFirstChild("HumanoidRootPart") then char.HumanoidRootPart.CFrame=startPosition end end; local char=player.Character; if char then local hrp=char:FindFirstChild("HumanoidRootPart"); if hrp then for _,v in pairs(hrp:GetChildren()) do if v.Name=="AirballPosition" then v:Destroy() end end end end end
local function startAirball() if isAirball then return end; if not startPosition then return end; local char=player.Character; if not char then return end; local hrp=char:FindFirstChild("HumanoidRootPart"); if not hrp then return end; isAirball=true; local highPos=CFrame.new(hrp.Position.X,10000,hrp.Position.Z); hrp.CFrame=highPos; local bp=Instance.new("BodyPosition"); bp.Name="AirballPosition"; bp.MaxForce=Vector3.new(1e5,1e5,1e5); bp.Position=highPos.Position; bp.P=10000; bp.D=500; bp.Parent=hrp; local bg2=Instance.new("BodyGyro"); bg2.Name="AirballPosition"; bg2.MaxTorque=Vector3.new(1e5,1e5,1e5); bg2.P=10000; bg2.Parent=hrp
    airballConnection=RunService.Heartbeat:Connect(function() if not isAirball or not char.Parent or not hrp.Parent then stopAirball(); return end; if bp and bp.Parent then bp.Position=Vector3.new(hrp.Position.X,10000,hrp.Position.Z) end; if bg2 and bg2.Parent then bg2.CFrame=workspace.CurrentCamera.CFrame end end) end
local function stopAutoTp() autoTpEnabled=false; autoTpTarget=nil end
local function startAutoTp(tp) if not tp then return end; autoTpEnabled=true; autoTpTarget=tp; local function ttt() if not autoTpTarget or not autoTpTarget.Character then return end; local tr=autoTpTarget.Character:FindFirstChild("HumanoidRootPart"); if tr and player.Character then local hrp=player.Character:FindFirstChild("HumanoidRootPart"); if hrp then hrp.CFrame=tr.CFrame*CFrame.new(0,0,-3) end end end; ttt(); player.CharacterAdded:Connect(function(c) if not autoTpEnabled then return end; c:WaitForChild("HumanoidRootPart"); task.wait(1.5); for i=1,3 do if not autoTpEnabled then break end; ttt(); if i<3 then task.wait(2) end end end) end
local function stopSpectating() if spectatingPlayer then Camera.CameraSubject=originalCameraSubject; spectatingPlayer=nil end end
local function spectatePlayer(p) if p and p.Character and p.Character:FindFirstChild("Humanoid") then if spectatingPlayer==p then stopSpectating() else spectatingPlayer=p; Camera.CameraSubject=p.Character.Humanoid end end end
local function teleportAttack(tp) if isTeleporting then return end; if not startPosition then return end; if not tp or not tp.Character then return end; local tH=tp.Character:FindFirstChild("Humanoid"); local tR=tp.Character:FindFirstChild("HumanoidRootPart"); if not tH or not tR then return end; local char=player.Character; if not char then return end; local hrp=char:FindFirstChild("HumanoidRootPart"); if not hrp then return end; isTeleporting=true; if not isFlying then startFlying() end; local st=tick()
    local conn; conn=RunService.Heartbeat:Connect(function() local el=tick()-st; if tH.Health<20 then task.wait(3.5); hrp.CFrame=startPosition; if isFlying then stopFlying() end; isTeleporting=false; conn:Disconnect(); return end; if el<4.0 then if tR and hrp then hrp.CFrame=tR.CFrame*CFrame.new(0,0,1) end else hrp.CFrame=startPosition; if isFlying then stopFlying() end; isTeleporting=false; conn:Disconnect() end end) end

--------------------------------------------------------------
-- GUI CONSTRUCTION
--------------------------------------------------------------
local screenGui=Instance.new("ScreenGui"); screenGui.Name="TempestV32"; screenGui.ResetOnSpawn=false; screenGui.ZIndexBehavior=Enum.ZIndexBehavior.Sibling; screenGui.Parent=playerGui

-- Pooled notification system (pre-built frames, no Instance.new per notif)
local notifContainer=Instance.new("Frame",screenGui); notifContainer.Name="Notifs"; notifContainer.Size=UDim2.new(0,350,1,-20); notifContainer.Position=UDim2.new(1,-360,0,10); notifContainer.BackgroundTransparency=1
local notifLayout=Instance.new("UIListLayout",notifContainer); notifLayout.SortOrder=Enum.SortOrder.LayoutOrder; notifLayout.Padding=UDim.new(0,8)

local NOTIF_POOL_SIZE = 8
local notifPool = {}
for i=1,NOTIF_POOL_SIZE do
    local n=Instance.new("Frame"); n.Size=UDim2.new(1,0,0,80); n.BackgroundColor3=Color3.fromRGB(37,37,38); n.BorderSizePixel=0; n.Visible=false; Instance.new("UICorner",n).CornerRadius=UDim.new(0,6)
    local bar=Instance.new("Frame",n); bar.Name="Bar"; bar.Size=UDim2.new(0,4,1,0); bar.BorderSizePixel=0; Instance.new("UICorner",bar).CornerRadius=UDim.new(0,6)
    local icn=Instance.new("TextLabel",n); icn.Name="Icon"; icn.Size=UDim2.new(0,30,0,30); icn.Position=UDim2.new(0,12,0,8); icn.BorderSizePixel=0; icn.TextColor3=Color3.fromRGB(255,255,255); icn.TextSize=18; icn.Font=Enum.Font.GothamBold; Instance.new("UICorner",icn).CornerRadius=UDim.new(1,0)
    local ttl=Instance.new("TextLabel",n); ttl.Name="Title"; ttl.Size=UDim2.new(1,-60,0,20); ttl.Position=UDim2.new(0,50,0,8); ttl.BackgroundTransparency=1; ttl.TextColor3=Color3.fromRGB(240,240,240); ttl.TextSize=13; ttl.Font=Enum.Font.GothamBold; ttl.TextXAlignment=Enum.TextXAlignment.Left
    local msg=Instance.new("TextLabel",n); msg.Name="Msg"; msg.Size=UDim2.new(1,-60,0,40); msg.Position=UDim2.new(0,50,0,30); msg.BackgroundTransparency=1; msg.TextColor3=Color3.fromRGB(180,180,180); msg.TextSize=11; msg.Font=Enum.Font.Gotham; msg.TextXAlignment=Enum.TextXAlignment.Left; msg.TextYAlignment=Enum.TextYAlignment.Top; msg.TextWrapped=true
    table.insert(notifPool, n)
end

local function notify(title, msgText, nType)
    if nType=="billboard_discovery" then billboardNotifsSuppressed=billboardNotifsSuppressed+1; return end
    if isScanActive and title=="New Billboard" then billboardNotifsSuppressed=billboardNotifsSuppressed+1; return end
    if activeNotifCount>=MAX_VISIBLE_NOTIFS then return end
    local n=nil; for _,pooled in ipairs(notifPool) do if not pooled.Visible then n=pooled; break end end
    if not n then return end
    local colors={success=Color3.fromRGB(0,200,100),warning=Color3.fromRGB(255,193,7),error=Color3.fromRGB(232,17,35),info=Color3.fromRGB(0,122,204),maybe=Color3.fromRGB(255,152,0)}
    local icons={success="âœ“",warning="âš ",error="âœ—",info="â„¹",maybe="?"}
    local color=colors[nType] or colors.info
    n.Bar.BackgroundColor3=color; n.Icon.BackgroundColor3=color; n.Icon.Text=icons[nType] or "â„¹"; n.Title.Text=title; n.Msg.Text=msgText
    n.Position=UDim2.new(1,10,0,0); n.Visible=true; n.Parent=notifContainer; activeNotifCount=activeNotifCount+1
    n:TweenPosition(UDim2.new(0,0,0,0),Enum.EasingDirection.Out,Enum.EasingStyle.Back,0.4,true)
    task.delay(5,function() pcall(function() activeNotifCount=math.max(0,activeNotifCount-1); n:TweenPosition(UDim2.new(1,10,0,0),Enum.EasingDirection.In,Enum.EasingStyle.Quad,0.3,true,function() n.Visible=false; n.Parent=nil end) end) end)
end

--------------------------------------------------------------
-- MAIN FRAME
--------------------------------------------------------------
local mainFrame=Instance.new("Frame",screenGui); mainFrame.Name="Main"; mainFrame.Size=UDim2.new(0,750,0,480); mainFrame.Position=UDim2.new(0.5,-375,0.5,-240); mainFrame.BackgroundColor3=Color3.fromRGB(45,45,48); mainFrame.BorderSizePixel=0; mainFrame.Active=true; mainFrame.ClipsDescendants=true; Instance.new("UICorner",mainFrame).CornerRadius=UDim.new(0,4)
local shadow=Instance.new("Frame",mainFrame); shadow.Size=UDim2.new(1,6,1,6); shadow.Position=UDim2.new(0,-3,0,-3); shadow.BackgroundColor3=Color3.fromRGB(0,0,0); shadow.BackgroundTransparency=0.7; shadow.BorderSizePixel=0; shadow.ZIndex=mainFrame.ZIndex-1; Instance.new("UICorner",shadow).CornerRadius=UDim.new(0,4)
local titleBar=Instance.new("Frame",mainFrame); titleBar.Name="TitleBar"; titleBar.Size=UDim2.new(1,0,0,30); titleBar.BackgroundColor3=Color3.fromRGB(30,30,30); titleBar.BorderSizePixel=0; Instance.new("UICorner",titleBar).CornerRadius=UDim.new(0,4)
local tbFix=Instance.new("Frame",titleBar); tbFix.Size=UDim2.new(1,0,0,4); tbFix.Position=UDim2.new(0,0,1,-4); tbFix.BackgroundColor3=Color3.fromRGB(30,30,30); tbFix.BorderSizePixel=0
local titleLabel=Instance.new("TextLabel",titleBar); titleLabel.Size=UDim2.new(0,200,1,0); titleLabel.Position=UDim2.new(0,10,0,0); titleLabel.BackgroundTransparency=1; titleLabel.Text="// Tempest v3.2"; titleLabel.TextColor3=Color3.fromRGB(220,220,220); titleLabel.TextSize=14; titleLabel.Font=Enum.Font.Code; titleLabel.TextXAlignment=Enum.TextXAlignment.Left
local sDot=Instance.new("Frame",titleBar); sDot.Size=UDim2.new(0,8,0,8); sDot.Position=UDim2.new(0,160,0.5,-4); sDot.BackgroundColor3=Color3.fromRGB(0,200,100); sDot.BorderSizePixel=0; Instance.new("UICorner",sDot).CornerRadius=UDim.new(1,0)
local sLbl=Instance.new("TextLabel",titleBar); sLbl.Size=UDim2.new(0,70,1,0); sLbl.Position=UDim2.new(0,172,0,0); sLbl.BackgroundTransparency=1; sLbl.Text="PROTECTED"; sLbl.TextColor3=Color3.fromRGB(0,200,100); sLbl.TextSize=9; sLbl.Font=Enum.Font.GothamBold; sLbl.TextXAlignment=Enum.TextXAlignment.Left
local currentScreen="billboard"
local switchBtn=Instance.new("TextButton",titleBar); switchBtn.Size=UDim2.new(0,105,0,22); switchBtn.Position=UDim2.new(0,252,0,4); switchBtn.BackgroundColor3=Color3.fromRGB(0,122,204); switchBtn.BorderSizePixel=0; switchBtn.Text="Combat â–¸"; switchBtn.TextColor3=Color3.fromRGB(255,255,255); switchBtn.TextSize=10; switchBtn.Font=Enum.Font.Code; Instance.new("UICorner",switchBtn).CornerRadius=UDim.new(0,3)
switchBtn.MouseEnter:Connect(function() switchBtn.BackgroundColor3=Color3.fromRGB(28,151,234) end); switchBtn.MouseLeave:Connect(function() switchBtn.BackgroundColor3=Color3.fromRGB(0,122,204) end)
local combatSecBtn=Instance.new("TextButton",titleBar); combatSecBtn.Size=UDim2.new(0,118,0,22); combatSecBtn.Position=UDim2.new(0,361,0,4); combatSecBtn.BackgroundColor3=Color3.fromRGB(160,40,200); combatSecBtn.BorderSizePixel=0; combatSecBtn.Text="âš¡ Combat 2 â–¸"; combatSecBtn.TextColor3=Color3.fromRGB(255,255,255); combatSecBtn.TextSize=10; combatSecBtn.Font=Enum.Font.Code; Instance.new("UICorner",combatSecBtn).CornerRadius=UDim.new(0,3)
combatSecBtn.MouseEnter:Connect(function() combatSecBtn.BackgroundColor3=Color3.fromRGB(190,70,230) end); combatSecBtn.MouseLeave:Connect(function() combatSecBtn.BackgroundColor3=Color3.fromRGB(160,40,200) end)
local closeBtn=Instance.new("TextButton",titleBar); closeBtn.Size=UDim2.new(0,30,0,30); closeBtn.Position=UDim2.new(1,-30,0,0); closeBtn.BackgroundColor3=Color3.fromRGB(40,40,40); closeBtn.BorderSizePixel=0; closeBtn.Text="Ã—"; closeBtn.TextColor3=Color3.fromRGB(220,220,220); closeBtn.TextSize=20; closeBtn.Font=Enum.Font.Code
closeBtn.MouseEnter:Connect(function() closeBtn.BackgroundColor3=Color3.fromRGB(232,17,35) end); closeBtn.MouseLeave:Connect(function() closeBtn.BackgroundColor3=Color3.fromRGB(40,40,40) end); closeBtn.MouseButton1Click:Connect(function() screenGui:Destroy() end)
local minBtn=Instance.new("TextButton",titleBar); minBtn.Size=UDim2.new(0,30,0,30); minBtn.Position=UDim2.new(1,-60,0,0); minBtn.BackgroundColor3=Color3.fromRGB(40,40,40); minBtn.BorderSizePixel=0; minBtn.Text="â€”"; minBtn.TextColor3=Color3.fromRGB(220,220,220); minBtn.TextSize=14; minBtn.Font=Enum.Font.Code
minBtn.MouseEnter:Connect(function() minBtn.BackgroundColor3=Color3.fromRGB(60,60,60) end); minBtn.MouseLeave:Connect(function() minBtn.BackgroundColor3=Color3.fromRGB(40,40,40) end)
local isMinimized=false; local fullSize=UDim2.new(0,750,0,480); local minSize=UDim2.new(0,750,0,30)
minBtn.MouseButton1Click:Connect(function() isMinimized=not isMinimized; TweenService:Create(mainFrame,TweenInfo.new(0.2,Enum.EasingStyle.Quad,Enum.EasingDirection.Out),{Size=isMinimized and minSize or fullSize}):Play() end)

--------------------------------------------------------------
-- BILLBOARD SCREEN
--------------------------------------------------------------
local billboardScreen=Instance.new("Frame",mainFrame); billboardScreen.Name="BS"; billboardScreen.Size=UDim2.new(1,-16,1,-38); billboardScreen.Position=UDim2.new(0,8,0,34); billboardScreen.BackgroundTransparency=1; billboardScreen.Visible=true
local bLP=Instance.new("Frame",billboardScreen); bLP.Size=UDim2.new(0,210,1,0); bLP.BackgroundColor3=Color3.fromRGB(37,37,38); bLP.BorderSizePixel=0; Instance.new("UICorner",bLP).CornerRadius=UDim.new(0,4)
local scanButton=Instance.new("TextButton",bLP); scanButton.Size=UDim2.new(1,-10,0,30); scanButton.Position=UDim2.new(0,5,0,5); scanButton.BackgroundColor3=Color3.fromRGB(0,122,204); scanButton.BorderSizePixel=0; scanButton.Text="âš¡ DEEP SCAN"; scanButton.TextColor3=Color3.fromRGB(255,255,255); scanButton.TextSize=12; scanButton.Font=Enum.Font.Code; Instance.new("UICorner",scanButton).CornerRadius=UDim.new(0,3)
scanButton.MouseEnter:Connect(function() scanButton.BackgroundColor3=Color3.fromRGB(28,151,234) end); scanButton.MouseLeave:Connect(function() scanButton.BackgroundColor3=Color3.fromRGB(0,122,204) end)
local countLabel=Instance.new("TextLabel",bLP); countLabel.Size=UDim2.new(1,-10,0,20); countLabel.Position=UDim2.new(0,5,0,40); countLabel.BackgroundTransparency=1; countLabel.Text="Found: 0 BBs"; countLabel.TextColor3=Color3.fromRGB(180,180,180); countLabel.TextSize=11; countLabel.Font=Enum.Font.Code; countLabel.TextXAlignment=Enum.TextXAlignment.Left
local billboardList=Instance.new("ScrollingFrame",bLP); billboardList.Size=UDim2.new(1,-10,1,-70); billboardList.Position=UDim2.new(0,5,0,65); billboardList.BackgroundColor3=Color3.fromRGB(30,30,30); billboardList.BorderSizePixel=0; billboardList.ScrollBarThickness=6; billboardList.ScrollBarImageColor3=Color3.fromRGB(100,100,100); billboardList.CanvasSize=UDim2.new(0,0,0,0); Instance.new("UICorner",billboardList).CornerRadius=UDim.new(0,3)
local listLayout=Instance.new("UIListLayout",billboardList); listLayout.SortOrder=Enum.SortOrder.LayoutOrder; listLayout.Padding=UDim.new(0,2)
local bRP=Instance.new("Frame",billboardScreen); bRP.Size=UDim2.new(1,-220,1,0); bRP.Position=UDim2.new(0,220,0,0); bRP.BackgroundColor3=Color3.fromRGB(37,37,38); bRP.BorderSizePixel=0; Instance.new("UICorner",bRP).CornerRadius=UDim.new(0,4)
local tabContainer=Instance.new("Frame",bRP); tabContainer.Size=UDim2.new(1,0,0,30); tabContainer.BackgroundTransparency=1
local tabNames={"Properties","Text Editor","Advanced","Analysis","Monitor","Batch"}; local tabButtons={}; local currentTab=1
for i,name in ipairs(tabNames) do local tb=Instance.new("TextButton",tabContainer); tb.Size=UDim2.new(1/#tabNames,-2,1,0); tb.Position=UDim2.new((i-1)*(1/#tabNames),0,0,0); tb.BackgroundColor3=Color3.fromRGB(45,45,48); tb.BorderSizePixel=0; tb.Text=name; tb.TextColor3=Color3.fromRGB(150,150,150); tb.TextSize=10; tb.Font=Enum.Font.Code; Instance.new("UICorner",tb).CornerRadius=UDim.new(0,3); tabButtons[i]=tb end
local tabContent=Instance.new("ScrollingFrame",bRP); tabContent.Size=UDim2.new(1,-10,1,-40); tabContent.Position=UDim2.new(0,5,0,35); tabContent.BackgroundColor3=Color3.fromRGB(30,30,30); tabContent.BorderSizePixel=0; tabContent.ScrollBarThickness=6; tabContent.ScrollBarImageColor3=Color3.fromRGB(100,100,100); tabContent.CanvasSize=UDim2.new(0,0,0,0); Instance.new("UICorner",tabContent).CornerRadius=UDim.new(0,3)

--------------------------------------------------------------
-- COMBAT SCREEN
--------------------------------------------------------------
local combatScreen=Instance.new("Frame",mainFrame); combatScreen.Name="CS"; combatScreen.Size=UDim2.new(1,-16,1,-38); combatScreen.Position=UDim2.new(0,8,0,34); combatScreen.BackgroundTransparency=1; combatScreen.Visible=false
local colW=(1/3)
local function makeCol(name,title,titleColor,xPos) local f=Instance.new("Frame",combatScreen); f.Name=name; f.Size=UDim2.new(colW,-6,1,-50); f.Position=UDim2.new(xPos,3,0,0); f.BackgroundColor3=Color3.fromRGB(37,37,38); f.BorderSizePixel=0; Instance.new("UICorner",f).CornerRadius=UDim.new(0,4); local t=Instance.new("TextLabel",f); t.Size=UDim2.new(1,0,0,30); t.BackgroundColor3=Color3.fromRGB(45,45,48); t.BorderSizePixel=0; t.Text=title; t.TextColor3=titleColor; t.TextSize=12; t.Font=Enum.Font.Code; Instance.new("UICorner",t).CornerRadius=UDim.new(0,4); local s=Instance.new("ScrollingFrame",f); s.Name="List"; s.Size=UDim2.new(1,-10,1,-40); s.Position=UDim2.new(0,5,0,35); s.BackgroundColor3=Color3.fromRGB(30,30,30); s.BorderSizePixel=0; s.ScrollBarThickness=6; s.ScrollBarImageColor3=Color3.fromRGB(100,100,100); s.CanvasSize=UDim2.new(0,0,0,0); Instance.new("UICorner",s).CornerRadius=UDim.new(0,3); local l=Instance.new("UIListLayout",s); l.SortOrder=Enum.SortOrder.Name; l.Padding=UDim.new(0,3); return f,s,l end
local specFrame,specList,specLayout=makeCol("Spec","// SPECTATE",Color3.fromRGB(100,200,255),0)
local tpFrame,tpList,tpLayout=makeCol("TPA","// TP ATTACK",Color3.fromRGB(255,100,100),colW)
local simpFrame,simpList,simpLayout=makeCol("TP","// TELEPORT",Color3.fromRGB(100,255,150),colW*2)
local combatBottom=Instance.new("Frame",combatScreen); combatBottom.Size=UDim2.new(1,0,0,45); combatBottom.Position=UDim2.new(0,0,1,-45); combatBottom.BackgroundColor3=Color3.fromRGB(30,30,30); combatBottom.BorderSizePixel=0; Instance.new("UICorner",combatBottom).CornerRadius=UDim.new(0,4)
local function makeBotBtn(text,pos,color,parent) local b=Instance.new("TextButton",parent or combatBottom); b.Size=UDim2.new(0.1666,-4,0,35); b.Position=pos; b.BackgroundColor3=color; b.BorderSizePixel=0; b.Text=text; b.TextColor3=Color3.fromRGB(255,255,255); b.TextSize=9; b.Font=Enum.Font.Code; Instance.new("UICorner",b).CornerRadius=UDim.new(0,5); return b end
local setStartBtn=makeBotBtn("Set Start",UDim2.new(0,5,0,5),Color3.fromRGB(70,130,180))
local flyBtn=makeBotBtn("Fly: OFF",UDim2.new(0.1666,2,0,5),Color3.fromRGB(180,70,70))
local tpStartBtn=makeBotBtn("TP Start",UDim2.new(0.3333,0,0,5),Color3.fromRGB(130,180,70))
local airballBtn=makeBotBtn("Airball",UDim2.new(0.5,-2,0,5),Color3.fromRGB(150,100,200))
local resetCamBtn=makeBotBtn("Reset Cam",UDim2.new(0.6666,-4,0,5),Color3.fromRGB(200,150,50))
local autoTpContainer=Instance.new("Frame",combatBottom); autoTpContainer.Size=UDim2.new(0.1666,-4,0,35); autoTpContainer.Position=UDim2.new(0.8333,-6,0,5); autoTpContainer.BackgroundTransparency=1
local autoTpBtn=Instance.new("TextButton",autoTpContainer); autoTpBtn.Size=UDim2.new(1,-20,1,0); autoTpBtn.BackgroundColor3=Color3.fromRGB(255,100,150); autoTpBtn.BorderSizePixel=0; autoTpBtn.Text="Auto TP"; autoTpBtn.TextColor3=Color3.fromRGB(255,255,255); autoTpBtn.TextSize=9; autoTpBtn.Font=Enum.Font.Code; Instance.new("UICorner",autoTpBtn).CornerRadius=UDim.new(0,5)
local arrowBtn=Instance.new("TextButton",autoTpContainer); arrowBtn.Size=UDim2.new(0,18,1,0); arrowBtn.Position=UDim2.new(1,-18,0,0); arrowBtn.BackgroundColor3=Color3.fromRGB(200,80,120); arrowBtn.BorderSizePixel=0; arrowBtn.Text="â–¼"; arrowBtn.TextColor3=Color3.fromRGB(255,255,255); arrowBtn.TextSize=10; arrowBtn.Font=Enum.Font.GothamBold; Instance.new("UICorner",arrowBtn).CornerRadius=UDim.new(0,5)
local autoTpDrop=Instance.new("ScrollingFrame",autoTpContainer); autoTpDrop.Size=UDim2.new(1,0,0,0); autoTpDrop.Position=UDim2.new(0,0,0,-130); autoTpDrop.BackgroundColor3=Color3.fromRGB(40,40,40); autoTpDrop.BorderSizePixel=1; autoTpDrop.BorderColor3=Color3.fromRGB(200,80,120); autoTpDrop.ScrollBarThickness=4; autoTpDrop.Visible=false; autoTpDrop.ZIndex=10; Instance.new("UICorner",autoTpDrop).CornerRadius=UDim.new(0,5)
local autoTpDropLayout=Instance.new("UIListLayout",autoTpDrop); autoTpDropLayout.SortOrder=Enum.SortOrder.Name; autoTpDropLayout.Padding=UDim.new(0,2)

local combatSecScreen -- forward declared, assigned below

local function showScreen(name)
    currentScreen=name
    billboardScreen.Visible=(name=="billboard")
    combatScreen.Visible=(name=="combat")
    if combatSecScreen then combatSecScreen.Visible=(name=="combatsec") end
    switchBtn.Text=(name~="billboard") and "â—‚ Billboard" or "Combat â–¸"
    combatSecBtn.Text=(name=="combatsec") and "â—‚ Back" or "âš¡ Combat 2 â–¸"
end
local function switchScreen() showScreen(currentScreen=="billboard" and "combat" or "billboard") end
switchBtn.MouseButton1Click:Connect(switchScreen)
combatSecBtn.MouseButton1Click:Connect(function() showScreen(currentScreen=="combatsec" and "billboard" or "combatsec") end)

--------------------------------------------------------------
-- BILLBOARD STATE & TAB RENDERERS
--------------------------------------------------------------
local detectedBillboards={}; local selectedBillboard=nil
local function clearTab() for _,child in ipairs(tabContent:GetChildren()) do if not child:IsA("UICorner") then child:Destroy() end end end

local function createPropEditor(parent,propName,propType,getVal,setVal)
    local c=Instance.new("Frame",parent); c.Size=UDim2.new(1,0,0,50); c.BackgroundColor3=Color3.fromRGB(45,45,48); c.BorderSizePixel=0; Instance.new("UICorner",c).CornerRadius=UDim.new(0,3)
    local lbl=Instance.new("TextLabel",c); lbl.Size=UDim2.new(1,-10,0,20); lbl.Position=UDim2.new(0,5,0,5); lbl.BackgroundTransparency=1; lbl.Text=propName.." ("..propType..")"; lbl.TextColor3=Color3.fromRGB(86,156,214); lbl.TextSize=11; lbl.Font=Enum.Font.Code; lbl.TextXAlignment=Enum.TextXAlignment.Left
    if propType=="boolean" then
        local tog=Instance.new("TextButton",c); tog.Size=UDim2.new(0,60,0,20); tog.Position=UDim2.new(0,5,0,25); tog.BackgroundColor3=getVal() and Color3.fromRGB(0,122,204) or Color3.fromRGB(60,60,60); tog.BorderSizePixel=0; tog.Text=tostring(getVal()); tog.TextColor3=Color3.fromRGB(255,255,255); tog.TextSize=11; tog.Font=Enum.Font.Code; Instance.new("UICorner",tog).CornerRadius=UDim.new(0,2)
        tog.MouseButton1Click:Connect(function() local nv=not getVal(); if selectedBillboard then local a=analysisCache[selectedBillboard]; if a and a.hasServerControl then attemptServerChange(selectedBillboard,propName,nv,a) else setVal(nv) end else setVal(nv) end; tog.Text=tostring(nv); tog.BackgroundColor3=nv and Color3.fromRGB(0,122,204) or Color3.fromRGB(60,60,60) end)
    else
        local box=Instance.new("TextBox",c); box.Size=UDim2.new(1,-10,0,20); box.Position=UDim2.new(0,5,0,25); box.BackgroundColor3=Color3.fromRGB(60,60,60); box.BorderSizePixel=0; box.Text=tostring(getVal()); box.TextColor3=Color3.fromRGB(220,220,220); box.TextSize=11; box.Font=Enum.Font.Code; box.ClearTextOnFocus=false; Instance.new("UICorner",box).CornerRadius=UDim.new(0,2)
        box.FocusLost:Connect(function(enter) if enter then safeCall(function() local v=box.Text; if propType=="number" then v=tonumber(v); if not v then box.Text=tostring(getVal()); return end; v=clampNum(v,-1e4,1e4) end; if selectedBillboard then local a=analysisCache[selectedBillboard]; if a and a.hasServerControl then attemptServerChange(selectedBillboard,propName,v,a) else setVal(v) end else setVal(v) end end,"Set "..propName) end end)
    end
end

local function renderProperties()
    clearTab(); if not selectedBillboard then local l=Instance.new("TextLabel",tabContent); l.Size=UDim2.new(1,0,1,0); l.BackgroundTransparency=1; l.Text="// Select a billboard"; l.TextColor3=Color3.fromRGB(150,150,150); l.TextSize=12; l.Font=Enum.Font.Code; return end
    local layout=Instance.new("UIListLayout",tabContent); layout.SortOrder=Enum.SortOrder.LayoutOrder; layout.Padding=UDim.new(0,5); local bb=selectedBillboard
    createPropEditor(tabContent,"Enabled","boolean",function() return bb.Enabled end,function(v) bb.Enabled=v end)
    createPropEditor(tabContent,"AlwaysOnTop","boolean",function() return bb.AlwaysOnTop end,function(v) bb.AlwaysOnTop=v end)
    createPropEditor(tabContent,"Active","boolean",function() return bb.Active end,function(v) bb.Active=v end)
    createPropEditor(tabContent,"ClipsDescendants","boolean",function() return bb.ClipsDescendants end,function(v) bb.ClipsDescendants=v end)
    createPropEditor(tabContent,"MaxDistance","number",function() return bb.MaxDistance end,function(v) bb.MaxDistance=v end)
    createPropEditor(tabContent,"LightInfluence","number",function() return bb.LightInfluence end,function(v) bb.LightInfluence=v end)
    createPropEditor(tabContent,"Size.X.Scale","number",function() return bb.Size.X.Scale end,function(v) bb.Size=UDim2.new(v,bb.Size.X.Offset,bb.Size.Y.Scale,bb.Size.Y.Offset) end)
    createPropEditor(tabContent,"Size.X.Offset","number",function() return bb.Size.X.Offset end,function(v) bb.Size=UDim2.new(bb.Size.X.Scale,v,bb.Size.Y.Scale,bb.Size.Y.Offset) end)
    createPropEditor(tabContent,"Size.Y.Scale","number",function() return bb.Size.Y.Scale end,function(v) bb.Size=UDim2.new(bb.Size.X.Scale,bb.Size.X.Offset,v,bb.Size.Y.Offset) end)
    createPropEditor(tabContent,"Size.Y.Offset","number",function() return bb.Size.Y.Offset end,function(v) bb.Size=UDim2.new(bb.Size.X.Scale,bb.Size.X.Offset,bb.Size.Y.Scale,v) end)
    createPropEditor(tabContent,"StudsOffset.X","number",function() return bb.StudsOffset.X end,function(v) bb.StudsOffset=Vector3.new(v,bb.StudsOffset.Y,bb.StudsOffset.Z) end)
    createPropEditor(tabContent,"StudsOffset.Y","number",function() return bb.StudsOffset.Y end,function(v) bb.StudsOffset=Vector3.new(bb.StudsOffset.X,v,bb.StudsOffset.Z) end)
    createPropEditor(tabContent,"StudsOffset.Z","number",function() return bb.StudsOffset.Z end,function(v) bb.StudsOffset=Vector3.new(bb.StudsOffset.X,bb.StudsOffset.Y,v) end)
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() tabContent.CanvasSize=UDim2.new(0,0,0,layout.AbsoluteContentSize.Y+10) end); tabContent.CanvasSize=UDim2.new(0,0,0,layout.AbsoluteContentSize.Y+10)
end

local function renderTextEditor()
    clearTab(); if not selectedBillboard then local l=Instance.new("TextLabel",tabContent); l.Size=UDim2.new(1,0,1,0); l.BackgroundTransparency=1; l.Text="// Select a billboard"; l.TextColor3=Color3.fromRGB(150,150,150); l.TextSize=12; l.Font=Enum.Font.Code; return end
    local elems={}; for _,d in ipairs(selectedBillboard:GetDescendants()) do if d:IsA("TextLabel") or d:IsA("TextBox") or d:IsA("TextButton") then table.insert(elems,d) end end
    if #elems==0 then local l=Instance.new("TextLabel",tabContent); l.Size=UDim2.new(1,0,1,0); l.BackgroundTransparency=1; l.Text="// No text elements"; l.TextColor3=Color3.fromRGB(150,150,150); l.TextSize=12; l.Font=Enum.Font.Code; return end
    local yPos=0
    for i,elem in ipairs(elems) do
        local c=Instance.new("Frame",tabContent); c.Size=UDim2.new(1,-10,0,130); c.Position=UDim2.new(0,5,0,yPos); c.BackgroundColor3=Color3.fromRGB(45,45,48); c.BorderSizePixel=0; Instance.new("UICorner",c).CornerRadius=UDim.new(0,3)
        local hdr=Instance.new("TextLabel",c); hdr.Size=UDim2.new(1,-10,0,20); hdr.Position=UDim2.new(0,5,0,5); hdr.BackgroundTransparency=1; hdr.Text=elem.ClassName.." â€” "..elem.Name; hdr.TextColor3=Color3.fromRGB(86,156,214); hdr.TextSize=11; hdr.Font=Enum.Font.Code; hdr.TextXAlignment=Enum.TextXAlignment.Left
        local tb=Instance.new("TextBox",c); tb.Size=UDim2.new(1,-10,0,40); tb.Position=UDim2.new(0,5,0,28); tb.BackgroundColor3=Color3.fromRGB(60,60,60); tb.BorderSizePixel=0; tb.Text=elem.Text; tb.TextColor3=Color3.fromRGB(220,220,220); tb.TextSize=11; tb.Font=Enum.Font.Code; tb.MultiLine=true; tb.TextWrapped=true; tb.ClearTextOnFocus=false; Instance.new("UICorner",tb).CornerRadius=UDim.new(0,2)
        local szLbl=Instance.new("TextLabel",c); szLbl.Size=UDim2.new(0,55,0,20); szLbl.Position=UDim2.new(0,5,0,73); szLbl.BackgroundTransparency=1; szLbl.Text="TextSize:"; szLbl.TextColor3=Color3.fromRGB(180,180,180); szLbl.TextSize=10; szLbl.Font=Enum.Font.Code; szLbl.TextXAlignment=Enum.TextXAlignment.Left
        local szBox=Instance.new("TextBox",c); szBox.Size=UDim2.new(0,50,0,20); szBox.Position=UDim2.new(0,60,0,73); szBox.BackgroundColor3=Color3.fromRGB(60,60,60); szBox.BorderSizePixel=0; szBox.Text=tostring(elem.TextSize); szBox.TextColor3=Color3.fromRGB(220,220,220); szBox.TextSize=10; szBox.Font=Enum.Font.Code; Instance.new("UICorner",szBox).CornerRadius=UDim.new(0,2)
        local clLbl=Instance.new("TextLabel",c); clLbl.Size=UDim2.new(0,35,0,20); clLbl.Position=UDim2.new(0,120,0,73); clLbl.BackgroundTransparency=1; clLbl.Text="RGB:"; clLbl.TextColor3=Color3.fromRGB(180,180,180); clLbl.TextSize=10; clLbl.Font=Enum.Font.Code; clLbl.TextXAlignment=Enum.TextXAlignment.Left
        local r,g,b=math.floor(elem.TextColor3.R*255),math.floor(elem.TextColor3.G*255),math.floor(elem.TextColor3.B*255)
        local rBox=Instance.new("TextBox",c); rBox.Size=UDim2.new(0,28,0,20); rBox.Position=UDim2.new(0,155,0,73); rBox.BackgroundColor3=Color3.fromRGB(60,60,60); rBox.BorderSizePixel=0; rBox.Text=tostring(r); rBox.TextColor3=Color3.fromRGB(255,140,140); rBox.TextSize=10; rBox.Font=Enum.Font.Code; Instance.new("UICorner",rBox).CornerRadius=UDim.new(0,2)
        local gBox=Instance.new("TextBox",c); gBox.Size=UDim2.new(0,28,0,20); gBox.Position=UDim2.new(0,186,0,73); gBox.BackgroundColor3=Color3.fromRGB(60,60,60); gBox.BorderSizePixel=0; gBox.Text=tostring(g); gBox.TextColor3=Color3.fromRGB(140,255,140); gBox.TextSize=10; gBox.Font=Enum.Font.Code; Instance.new("UICorner",gBox).CornerRadius=UDim.new(0,2)
        local bBox=Instance.new("TextBox",c); bBox.Size=UDim2.new(0,28,0,20); bBox.Position=UDim2.new(0,217,0,73); bBox.BackgroundColor3=Color3.fromRGB(60,60,60); bBox.BorderSizePixel=0; bBox.Text=tostring(b); bBox.TextColor3=Color3.fromRGB(140,140,255); bBox.TextSize=10; bBox.Font=Enum.Font.Code; Instance.new("UICorner",bBox).CornerRadius=UDim.new(0,2)
        local applyBtn=Instance.new("TextButton",c); applyBtn.Size=UDim2.new(0,70,0,22); applyBtn.Position=UDim2.new(0,5,0,100); applyBtn.BackgroundColor3=Color3.fromRGB(0,122,204); applyBtn.BorderSizePixel=0; applyBtn.Text="APPLY"; applyBtn.TextColor3=Color3.fromRGB(255,255,255); applyBtn.TextSize=10; applyBtn.Font=Enum.Font.Code; Instance.new("UICorner",applyBtn).CornerRadius=UDim.new(0,2)
        local srvBtn=Instance.new("TextButton",c); srvBtn.Size=UDim2.new(0,100,0,22); srvBtn.Position=UDim2.new(0,80,0,100); srvBtn.BackgroundColor3=Color3.fromRGB(0,200,100); srvBtn.BorderSizePixel=0; srvBtn.Text="âš¡ SERVER"; srvBtn.TextColor3=Color3.fromRGB(255,255,255); srvBtn.TextSize=10; srvBtn.Font=Enum.Font.Code; Instance.new("UICorner",srvBtn).CornerRadius=UDim.new(0,2)
        applyBtn.MouseButton1Click:Connect(function() safeCall(function() safeProp(elem,"Text",tb.Text); local ns=tonumber(szBox.Text); if ns then safeProp(elem,"TextSize",clampNum(ns,1,200)) end; local nr,ng,nb=tonumber(rBox.Text),tonumber(gBox.Text),tonumber(bBox.Text); if nr and ng and nb then safeProp(elem,"TextColor3",Color3.fromRGB(clampNum(nr,0,255),clampNum(ng,0,255),clampNum(nb,0,255))) end; applyBtn.Text="âœ“"; task.wait(0.5); applyBtn.Text="APPLY" end) end)
        srvBtn.MouseButton1Click:Connect(function() safeCall(function() local a=analysisCache[selectedBillboard]; attemptServerTextChange(elem,tb.Text,selectedBillboard,a); local ns=tonumber(szBox.Text); if ns then attemptServerChange(selectedBillboard,"TextSize",clampNum(ns,1,200),a) end; srvBtn.Text="âœ“ SENT"; task.wait(0.5); srvBtn.Text="âš¡ SERVER" end) end)
        yPos=yPos+135
    end
    tabContent.CanvasSize=UDim2.new(0,0,0,yPos)
end

local function renderAdvanced()
    clearTab(); if not selectedBillboard then local l=Instance.new("TextLabel",tabContent); l.Size=UDim2.new(1,0,1,0); l.BackgroundTransparency=1; l.Text="// Select a billboard"; l.TextColor3=Color3.fromRGB(150,150,150); l.TextSize=12; l.Font=Enum.Font.Code; return end
    local layout=Instance.new("UIListLayout",tabContent); layout.SortOrder=Enum.SortOrder.LayoutOrder; layout.Padding=UDim.new(0,5); local bb=selectedBillboard
    local actions={
        {"Clone",Color3.fromRGB(0,122,204),function() safeCall(function() local cl=bb:Clone(); cl.Parent=bb.Parent; cl.StudsOffset=bb.StudsOffset+Vector3.new(2,0,0); notify("Cloned","Done","success") end) end},
        {"Toggle Children",Color3.fromRGB(0,122,204),function() safeCall(function() for _,d in ipairs(bb:GetDescendants()) do if d:IsA("GuiObject") then d.Visible=not d.Visible end end end) end},
        {"Max Visibility",Color3.fromRGB(0,200,100),function() safeCall(function() local a=analysisCache[bb]; attemptServerChange(bb,"MaxDistance",100000,a); attemptServerChange(bb,"AlwaysOnTop",true,a); notify("Max Vis","Done","success") end) end},
        {"Force Enable",Color3.fromRGB(0,200,100),function() safeCall(function() attemptServerChange(bb,"Enabled",true,analysisCache[bb]) end) end},
        {"Force Disable",Color3.fromRGB(255,152,0),function() safeCall(function() attemptServerChange(bb,"Enabled",false,analysisCache[bb]) end) end},
        {"Brute Force ALL",Color3.fromRGB(232,17,35),function() safeCall(function() local a=analysisCache[bb]; if not a then return end; local cnt=0; for _,e in ipairs(a.rankedRemotes) do cnt=cnt+1; if e.remote:IsA("RemoteEvent") then for _,p in ipairs(a.argPatterns) do safeCall(function() e.remote:FireServer(p("Text","Test")) end) end end end; notify("Brute Force",cnt.." remotes fired","warning") end) end},
        {"Snapshot",Color3.fromRGB(0,122,204),function() snapshotBillboard(bb); notify("Snapshot","Saved","info") end},
        {"Detect Changes",Color3.fromRGB(0,122,204),function() local ch=detectChanges(bb); if #ch==0 then notify("No Changes","","info") else notify("Changes",table.concat(ch,"\n"),"warning") end end},
        {"DELETE",Color3.fromRGB(232,17,35),function() safeCall(function() bb:Destroy(); selectedBillboard=nil; notify("Deleted","","error"); renderAdvanced() end) end},
    }
    for _,act in ipairs(actions) do local btn=Instance.new("TextButton",tabContent); btn.Size=UDim2.new(1,-10,0,28); btn.BackgroundColor3=act[2]; btn.BorderSizePixel=0; btn.Text=act[1]; btn.TextColor3=Color3.fromRGB(255,255,255); btn.TextSize=11; btn.Font=Enum.Font.Code; Instance.new("UICorner",btn).CornerRadius=UDim.new(0,3); btn.MouseButton1Click:Connect(act[3]) end
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() tabContent.CanvasSize=UDim2.new(0,0,0,layout.AbsoluteContentSize.Y+10) end)
end

local function renderAnalysis()
    clearTab(); if not selectedBillboard then local l=Instance.new("TextLabel",tabContent); l.Size=UDim2.new(1,0,1,0); l.BackgroundTransparency=1; l.Text="// Select a billboard"; l.TextColor3=Color3.fromRGB(150,150,150); l.TextSize=12; l.Font=Enum.Font.Code; return end
    local a=analysisCache[selectedBillboard] or ultraAnalyze(selectedBillboard)
    local layout=Instance.new("UIListLayout",tabContent); layout.SortOrder=Enum.SortOrder.LayoutOrder; layout.Padding=UDim.new(0,5)
    local confC=Instance.new("Frame",tabContent); confC.Size=UDim2.new(1,-10,0,55); confC.BackgroundColor3=Color3.fromRGB(45,45,48); confC.BorderSizePixel=0; Instance.new("UICorner",confC).CornerRadius=UDim.new(0,3)
    local confColor=a.confidence>=70 and Color3.fromRGB(0,200,100) or (a.confidence>=30 and Color3.fromRGB(255,152,0) or Color3.fromRGB(232,17,35))
    local confText=a.confidence>=70 and "âœ“ Server-Side Editable" or (a.confidence>=30 and "âš  Maybe Server-Side" or "âœ— Local Only")
    local cl=Instance.new("TextLabel",confC); cl.Size=UDim2.new(1,-10,0,25); cl.Position=UDim2.new(0,5,0,5); cl.BackgroundColor3=Color3.fromRGB(30,30,30); cl.BorderSizePixel=0; cl.Text=confText.." ("..a.confidence.."%)"; cl.TextColor3=confColor; cl.TextSize=13; cl.Font=Enum.Font.GothamBold; Instance.new("UICorner",cl).CornerRadius=UDim.new(0,2)
    local ol=Instance.new("TextLabel",confC); ol.Size=UDim2.new(1,-10,0,16); ol.Position=UDim2.new(0,5,0,33); ol.BackgroundTransparency=1; ol.TextColor3=Color3.fromRGB(180,180,180); ol.TextSize=10; ol.Font=Enum.Font.Code; ol.TextXAlignment=Enum.TextXAlignment.Left; ol.Text="Owner: "..(a.isPlayerOwned and "You" or "Server/Other")
    local function addSec(title,items,fmt)
        if #items==0 then return end
        local s=Instance.new("Frame",tabContent); s.Size=UDim2.new(1,-10,0,22+math.min(#items,12)*20); s.BackgroundColor3=Color3.fromRGB(45,45,48); s.BorderSizePixel=0; Instance.new("UICorner",s).CornerRadius=UDim.new(0,3)
        local sl2=Instance.new("TextLabel",s); sl2.Size=UDim2.new(1,-10,0,18); sl2.Position=UDim2.new(0,5,0,2); sl2.BackgroundTransparency=1; sl2.Text=title.." ("..#items..")"; sl2.TextColor3=Color3.fromRGB(86,156,214); sl2.TextSize=11; sl2.Font=Enum.Font.Code; sl2.TextXAlignment=Enum.TextXAlignment.Left
        for ii,item in ipairs(items) do if ii>12 then break end; local il=Instance.new("TextLabel",s); il.Size=UDim2.new(1,-16,0,18); il.Position=UDim2.new(0,10,0,20+(ii-1)*20); il.BackgroundTransparency=1; il.Text=fmt(item); il.TextColor3=Color3.fromRGB(200,200,200); il.TextSize=9; il.Font=Enum.Font.Code; il.TextXAlignment=Enum.TextXAlignment.Left; il.TextTruncate=Enum.TextTruncate.AtEnd end
    end
    addSec("Ranked Remotes",a.rankedRemotes,function(r) return string.format("[%.0f] %s â€” %s",r.score,r.remote.Name,r.type) end)
    addSec("GUI TextBoxes",a.guiMethods.textBoxes,function(t) return string.format("[%.0f] %s",t.score,t.obj.Name) end)
    addSec("Submit Buttons",a.guiMethods.submitButtons,function(bn) return string.format("[%.0f] %s",bn.score,bn.obj.Name) end)
    addSec("StringValues",a.valueObjects.strings,function(sv) return string.format("[%.0f] %s = \"%s\"",sv.score,sv.obj.Name,sv.value:sub(1,30)) end)
    addSec("Attributes",a.attributeControls,function(ac) return string.format("[%.0f] %s.%s",ac.score,ac.instance.Name,ac.name) end)
    addSec("Bindable Events",a.bindables.events,function(be) return string.format("[%.0f] %s",be.score,be.obj.Name) end)
    addSec("Server Scripts",a.scripts.server,function(s) return s.path:sub(-60) end)
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() tabContent.CanvasSize=UDim2.new(0,0,0,layout.AbsoluteContentSize.Y+10) end)
end

local function renderMonitor()
    clearTab(); if not selectedBillboard then local l=Instance.new("TextLabel",tabContent); l.Size=UDim2.new(1,0,1,0); l.BackgroundTransparency=1; l.Text="// Select a billboard"; l.TextColor3=Color3.fromRGB(150,150,150); l.TextSize=12; l.Font=Enum.Font.Code; return end
    local layout=Instance.new("UIListLayout",tabContent); layout.SortOrder=Enum.SortOrder.LayoutOrder; layout.Padding=UDim.new(0,2)
    local monBtn=Instance.new("TextButton",tabContent); monBtn.Size=UDim2.new(1,-10,0,28); monBtn.BackgroundColor3=Color3.fromRGB(0,200,100); monBtn.BorderSizePixel=0; monBtn.Text="â–¶ START MONITORING"; monBtn.TextColor3=Color3.fromRGB(255,255,255); monBtn.TextSize=11; monBtn.Font=Enum.Font.Code; Instance.new("UICorner",monBtn).CornerRadius=UDim.new(0,3)
    local logScroll=Instance.new("ScrollingFrame",tabContent); logScroll.Size=UDim2.new(1,-10,0,340); logScroll.BackgroundColor3=Color3.fromRGB(25,25,28); logScroll.BorderSizePixel=0; logScroll.ScrollBarThickness=4; logScroll.ScrollBarImageColor3=Color3.fromRGB(100,100,100); logScroll.CanvasSize=UDim2.new(0,0,0,0); Instance.new("UICorner",logScroll).CornerRadius=UDim.new(0,3)
    local logLayout=Instance.new("UIListLayout",logScroll); logLayout.SortOrder=Enum.SortOrder.LayoutOrder; logLayout.Padding=UDim.new(0,1)
    local monitoring,logIdx=false,0
    local function addLog(p,v) logIdx=logIdx+1; local e=Instance.new("TextLabel",logScroll); e.Size=UDim2.new(1,-8,0,16); e.BackgroundTransparency=1; e.Text=string.format("[%04d] %s â†’ %s",logIdx,p,tostring(v):sub(1,50)); e.TextColor3=p:find("Text") and Color3.fromRGB(0,200,100) or Color3.fromRGB(180,180,180); e.TextSize=9; e.Font=Enum.Font.Code; e.TextXAlignment=Enum.TextXAlignment.Left; logScroll.CanvasSize=UDim2.new(0,0,0,logLayout.AbsoluteContentSize.Y+5); logScroll.CanvasPosition=Vector2.new(0,logLayout.AbsoluteContentSize.Y) end
    monBtn.MouseButton1Click:Connect(function() monitoring=not monitoring
        if monitoring then monBtn.Text="â¸ STOP"; monBtn.BackgroundColor3=Color3.fromRGB(232,17,35); addLog("SYSTEM","Monitoring "..selectedBillboard.Name); watchBillboard(selectedBillboard,function(p,v) if monitoring then addLog(p,v) end end); snapshotBillboard(selectedBillboard)
        else monBtn.Text="â–¶ START MONITORING"; monBtn.BackgroundColor3=Color3.fromRGB(0,200,100); if activeWatchers[selectedBillboard] then for _,cn in ipairs(activeWatchers[selectedBillboard]) do safeCall(function() cn:Disconnect() end) end; activeWatchers[selectedBillboard]=nil end end
    end)
end

local function renderBatch()
    clearTab()
    local layout=Instance.new("UIListLayout",tabContent); layout.SortOrder=Enum.SortOrder.LayoutOrder; layout.Padding=UDim.new(0,5)
    local infoL=Instance.new("TextLabel",tabContent); infoL.Size=UDim2.new(1,-10,0,25); infoL.BackgroundTransparency=1; infoL.Text="// Batch on ALL "..#detectedBillboards.." billboards"; infoL.TextColor3=Color3.fromRGB(86,156,214); infoL.TextSize=12; infoL.Font=Enum.Font.Code; infoL.TextXAlignment=Enum.TextXAlignment.Left
    local tc=Instance.new("Frame",tabContent); tc.Size=UDim2.new(1,-10,0,60); tc.BackgroundColor3=Color3.fromRGB(45,45,48); tc.BorderSizePixel=0; Instance.new("UICorner",tc).CornerRadius=UDim.new(0,3)
    local btLbl=Instance.new("TextLabel",tc); btLbl.Size=UDim2.new(1,-10,0,18); btLbl.Position=UDim2.new(0,5,0,3); btLbl.BackgroundTransparency=1; btLbl.Text="Batch Text Replace"; btLbl.TextColor3=Color3.fromRGB(86,156,214); btLbl.TextSize=11; btLbl.Font=Enum.Font.Code; btLbl.TextXAlignment=Enum.TextXAlignment.Left
    local btBox=Instance.new("TextBox",tc); btBox.Size=UDim2.new(0.6,-8,0,22); btBox.Position=UDim2.new(0,5,0,25); btBox.BackgroundColor3=Color3.fromRGB(60,60,60); btBox.BorderSizePixel=0; btBox.Text=""; btBox.PlaceholderText="New text..."; btBox.TextColor3=Color3.fromRGB(220,220,220); btBox.TextSize=10; btBox.Font=Enum.Font.Code; btBox.ClearTextOnFocus=false; Instance.new("UICorner",btBox).CornerRadius=UDim.new(0,2)
    local btBtn=Instance.new("TextButton",tc); btBtn.Size=UDim2.new(0.35,0,0,22); btBtn.Position=UDim2.new(0.62,0,0,25); btBtn.BackgroundColor3=Color3.fromRGB(0,200,100); btBtn.BorderSizePixel=0; btBtn.Text="APPLY ALL"; btBtn.TextColor3=Color3.fromRGB(255,255,255); btBtn.TextSize=10; btBtn.Font=Enum.Font.Code; Instance.new("UICorner",btBtn).CornerRadius=UDim.new(0,2)
    btBtn.MouseButton1Click:Connect(function() local txt=btBox.Text; local ct=0; for _,bb in ipairs(detectedBillboards) do for _,d in ipairs(bb:GetDescendants()) do if d:IsA("TextLabel") or d:IsA("TextBox") or d:IsA("TextButton") then attemptServerTextChange(d,txt,bb,analysisCache[bb]); ct=ct+1 end end end; notify("Batch","Updated "..ct.." elements","success") end)
    local ops={{"Enable All",function() for _,bb in ipairs(detectedBillboards) do attemptServerChange(bb,"Enabled",true,analysisCache[bb]) end; notify("Batch","Enabled all","success") end},{"Disable All",function() for _,bb in ipairs(detectedBillboards) do attemptServerChange(bb,"Enabled",false,analysisCache[bb]) end end},{"AlwaysOnTop All",function() for _,bb in ipairs(detectedBillboards) do attemptServerChange(bb,"AlwaysOnTop",true,analysisCache[bb]) end end},{"Max Distance All",function() for _,bb in ipairs(detectedBillboards) do attemptServerChange(bb,"MaxDistance",100000,analysisCache[bb]) end end},{"Snapshot All",function() for _,bb in ipairs(detectedBillboards) do snapshotBillboard(bb) end end},{"Analyze All",function() for _,bb in ipairs(detectedBillboards) do ultraAnalyze(bb) end end}}
    for _,op in ipairs(ops) do local btn=Instance.new("TextButton",tabContent); btn.Size=UDim2.new(1,-10,0,28); btn.BackgroundColor3=Color3.fromRGB(0,122,204); btn.BorderSizePixel=0; btn.Text=op[1]; btn.TextColor3=Color3.fromRGB(255,255,255); btn.TextSize=11; btn.Font=Enum.Font.Code; Instance.new("UICorner",btn).CornerRadius=UDim.new(0,3); btn.MouseButton1Click:Connect(function() safeCall(op[2],op[1]) end) end
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() tabContent.CanvasSize=UDim2.new(0,0,0,layout.AbsoluteContentSize.Y+10) end)
end

local tabRenderers={renderProperties,renderTextEditor,renderAdvanced,renderAnalysis,renderMonitor,renderBatch}
local function switchTab(idx) currentTab=idx; for i,btn in ipairs(tabButtons) do if i==idx then btn.BackgroundColor3=Color3.fromRGB(0,122,204); btn.TextColor3=Color3.fromRGB(255,255,255) else btn.BackgroundColor3=Color3.fromRGB(45,45,48); btn.TextColor3=Color3.fromRGB(150,150,150) end end; tabRenderers[idx]() end
for i,btn in ipairs(tabButtons) do btn.MouseButton1Click:Connect(function() switchTab(i) end) end

--------------------------------------------------------------
-- SCAN & POPULATE
--------------------------------------------------------------
local scanInProgress=false
local function scanAndPopulate()
    if scanInProgress then notify("Scan","Already scanning...","warning"); return end
    task.spawn(function()
        scanInProgress=true; isScanActive=true; billboardNotifsSuppressed=0
        scanButton.Text="â³ SCANNING..."; scanButton.BackgroundColor3=Color3.fromRGB(180,70,70)
        countLabel.Text="Scanning..."; task.wait()
        local scanned=deepScanGame(); countLabel.Text="Indexed "..scanned.." objects..."; task.wait()
        detectedBillboards={}; for _,child in ipairs(billboardList:GetChildren()) do if child:IsA("TextButton") then child:Destroy() end end
        local function collectBBs(root) local ok,descs=pcall(function() return root:GetDescendants() end); if not ok then return end
            for i,obj in ipairs(descs) do if i%SCAN_BATCH==0 then task.wait() end
                if obj.ClassName=="BillboardGui" and not isChatBubble(obj) then table.insert(detectedBillboards,obj) end
            end
        end
        collectBBs(workspace); pcall(function() if character then collectBBs(character) end end); pcall(function() collectBBs(playerGui) end)
        countLabel.Text="Found "..#detectedBillboards.." BBs, analyzing..."; task.wait()
        for i,bb in ipairs(detectedBillboards) do if i%ANALYZE_BATCH==0 then countLabel.Text="Analyzing "..i.."/"..#detectedBillboards.."..."; task.wait() end; safeCall(function() ultraAnalyze(bb) end) end
        countLabel.Text="Building list..."; task.wait()
        for i,bb in ipairs(detectedBillboards) do if i%5==0 then task.wait() end; safeCall(function()
            local a=analysisCache[bb]; local owned=isPlayerOwned(bb); local conf=a and a.confidence or 0
            local listBtn=Instance.new("TextButton",billboardList); listBtn.Size=UDim2.new(1,0,0,35); listBtn.BackgroundColor3=Color3.fromRGB(45,45,48); listBtn.BorderSizePixel=0; listBtn.Text=bb.Name..(owned and " (Yours)" or ""); listBtn.TextColor3=Color3.fromRGB(220,220,220); listBtn.TextSize=11; listBtn.Font=Enum.Font.Code; Instance.new("UICorner",listBtn).CornerRadius=UDim.new(0,2)
            local dot=Instance.new("Frame",listBtn); dot.Size=UDim2.new(0,6,0,6); dot.Position=UDim2.new(1,-12,0,5); dot.BackgroundColor3=conf>=70 and Color3.fromRGB(0,200,100) or (conf>=30 and Color3.fromRGB(255,152,0) or Color3.fromRGB(100,100,100)); dot.BorderSizePixel=0; Instance.new("UICorner",dot).CornerRadius=UDim.new(1,0)
            local pathLbl=Instance.new("TextLabel",listBtn); pathLbl.Size=UDim2.new(1,-10,0,15); pathLbl.Position=UDim2.new(0,5,0,18); pathLbl.BackgroundTransparency=1; pathLbl.Text=(bb.Parent and bb.Parent.Name or "?").." Â· "..conf.."%"; pathLbl.TextColor3=Color3.fromRGB(150,150,150); pathLbl.TextSize=9; pathLbl.Font=Enum.Font.Code; pathLbl.TextXAlignment=Enum.TextXAlignment.Left
            listBtn.MouseEnter:Connect(function() listBtn.BackgroundColor3=Color3.fromRGB(60,60,60) end)
            listBtn.MouseLeave:Connect(function() listBtn.BackgroundColor3=selectedBillboard==bb and Color3.fromRGB(0,122,204) or Color3.fromRGB(45,45,48) end)
            listBtn.MouseButton1Click:Connect(function() safeCall(function()
                selectedBillboard=bb; for _,bt in ipairs(billboardList:GetChildren()) do if bt:IsA("TextButton") then bt.BackgroundColor3=Color3.fromRGB(45,45,48) end end; listBtn.BackgroundColor3=Color3.fromRGB(0,122,204)
                local cap=conf>=70 and "success" or (conf>=30 and "maybe" or "error"); local capMsg=conf>=70 and "Server-Side" or (conf>=30 and "Maybe" or "Local Only")
                notify(capMsg.." ("..conf.."%)",(#(a and a.rankedRemotes or {})).." remotes",cap); switchTab(currentTab)
            end) end)
        end,"List "..i) end
        listLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function() billboardList.CanvasSize=UDim2.new(0,0,0,listLayout.AbsoluteContentSize.Y+5) end)
        billboardList.CanvasSize=UDim2.new(0,0,0,listLayout.AbsoluteContentSize.Y+5)
        isScanActive=false; scanInProgress=false
        scanButton.Text="âš¡ DEEP SCAN"; scanButton.BackgroundColor3=Color3.fromRGB(0,122,204)
        countLabel.Text=string.format("Found: %d BBs | %d REs | %d RFs",#detectedBillboards,#DB.remoteEvents,#DB.remoteFunctions)
        notify("Scan Complete",#detectedBillboards.." BBs Â· "..#DB.remoteEvents.." REs Â· "..scanned.." objects","success")
    end)
end
scanButton.MouseButton1Click:Connect(scanAndPopulate)

--------------------------------------------------------------
-- COMBAT PLAYER LISTS
--------------------------------------------------------------
local function makePlayerBtn(parent,pName,callback) local b=Instance.new("TextButton",parent); b.Name=pName; b.Size=UDim2.new(1,-10,0,28); b.BackgroundColor3=Color3.fromRGB(45,45,48); b.BorderSizePixel=0; b.Text=pName; b.TextColor3=Color3.fromRGB(220,220,220); b.TextSize=11; b.Font=Enum.Font.Code; Instance.new("UICorner",b).CornerRadius=UDim.new(0,3); b.MouseEnter:Connect(function() b.BackgroundColor3=Color3.fromRGB(60,60,60) end); b.MouseLeave:Connect(function() b.BackgroundColor3=Color3.fromRGB(45,45,48) end); b.MouseButton1Click:Connect(callback); return b end

local function updateCombatLists()
    for _,list in ipairs({specList,tpList,simpList}) do for _,child in ipairs(list:GetChildren()) do if child:IsA("TextButton") then child:Destroy() end end end
    for _,child in ipairs(autoTpDrop:GetChildren()) do if child:IsA("TextButton") then child:Destroy() end end
    for _,p in ipairs(Players:GetPlayers()) do if p~=player then local dName=p.DisplayName
        makePlayerBtn(specList,dName,function() spectatePlayer(p); for _,btn in ipairs(specList:GetChildren()) do if btn:IsA("TextButton") then btn.BackgroundColor3=(spectatingPlayer==p) and Color3.fromRGB(0,122,204) or Color3.fromRGB(45,45,48) end end end)
        makePlayerBtn(tpList,dName,function() teleportAttack(p); flyBtn.Text=isFlying and "Fly: ON" or "Fly: OFF"; flyBtn.BackgroundColor3=isFlying and Color3.fromRGB(70,180,70) or Color3.fromRGB(180,70,70) end)
        makePlayerBtn(simpList,dName,function() if p and p.Character then local tr=p.Character:FindFirstChild("HumanoidRootPart"); if tr and player.Character then local hrp=player.Character:FindFirstChild("HumanoidRootPart"); if hrp then hrp.CFrame=tr.CFrame*CFrame.new(0,0,3) end end end end)
        local db=Instance.new("TextButton",autoTpDrop); db.Name=p.Name; db.Size=UDim2.new(1,-5,0,22); db.BackgroundColor3=Color3.fromRGB(45,45,48); db.BorderSizePixel=0; db.Text=dName; db.TextColor3=Color3.fromRGB(220,220,220); db.TextSize=9; db.Font=Enum.Font.Code; db.ZIndex=11; Instance.new("UICorner",db).CornerRadius=UDim.new(0,3)
        db.MouseButton1Click:Connect(function() if autoTpEnabled and autoTpTarget==p then stopAutoTp(); autoTpBtn.Text="Auto TP"; autoTpBtn.BackgroundColor3=Color3.fromRGB(255,100,150) else stopAutoTp(); startAutoTp(p); autoTpBtn.Text=dName; autoTpBtn.BackgroundColor3=Color3.fromRGB(0,200,100) end; autoTpDrop.Visible=false; arrowBtn.Text="â–¼" end)
    end end
    specList.CanvasSize=UDim2.new(0,0,0,specLayout.AbsoluteContentSize.Y+10)
    tpList.CanvasSize=UDim2.new(0,0,0,tpLayout.AbsoluteContentSize.Y+10)
    simpList.CanvasSize=UDim2.new(0,0,0,simpLayout.AbsoluteContentSize.Y+10)
    autoTpDrop.CanvasSize=UDim2.new(0,0,0,autoTpDropLayout.AbsoluteContentSize.Y+5)
end

setStartBtn.MouseButton1Click:Connect(function() if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then startPosition=player.Character.HumanoidRootPart.CFrame; setStartBtn.Text="âœ“ Set!"; setStartBtn.BackgroundColor3=Color3.fromRGB(0,200,100); task.wait(1); setStartBtn.Text="Set Start"; setStartBtn.BackgroundColor3=Color3.fromRGB(70,130,180) end end)
flyBtn.MouseButton1Click:Connect(function() if isFlying then stopFlying(); flyBtn.Text="Fly: OFF"; flyBtn.BackgroundColor3=Color3.fromRGB(180,70,70) else startFlying(); flyBtn.Text="Fly: ON"; flyBtn.BackgroundColor3=Color3.fromRGB(70,180,70) end end)
tpStartBtn.MouseButton1Click:Connect(function() if not startPosition then tpStartBtn.Text="No Start!"; task.wait(1); tpStartBtn.Text="TP Start"; return end; if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then player.Character.HumanoidRootPart.CFrame=startPosition end end)
airballBtn.MouseButton1Click:Connect(function() if isAirball then stopAirball(); airballBtn.Text="Airball"; airballBtn.BackgroundColor3=Color3.fromRGB(150,100,200) else if not startPosition then airballBtn.Text="No Start!"; task.wait(1); airballBtn.Text="Airball"; return end; startAirball(); airballBtn.Text="Airball: ON"; airballBtn.BackgroundColor3=Color3.fromRGB(200,100,255) end end)
resetCamBtn.MouseButton1Click:Connect(function() stopSpectating(); Camera.CameraSubject=player.Character and player.Character:FindFirstChild("Humanoid") or originalCameraSubject; for _,btn in ipairs(specList:GetChildren()) do if btn:IsA("TextButton") then btn.BackgroundColor3=Color3.fromRGB(45,45,48) end end end)
autoTpBtn.MouseButton1Click:Connect(function() if autoTpEnabled then stopAutoTp(); autoTpBtn.Text="Auto TP"; autoTpBtn.BackgroundColor3=Color3.fromRGB(255,100,150) end end)
arrowBtn.MouseButton1Click:Connect(function() autoTpDrop.Visible=not autoTpDrop.Visible; if autoTpDrop.Visible then arrowBtn.Text="â–²"; autoTpDrop.Size=UDim2.new(1,0,0,math.min(autoTpDropLayout.AbsoluteContentSize.Y+5,120)) else arrowBtn.Text="â–¼" end end)
Players.PlayerAdded:Connect(function() task.wait(0.5); updateCombatLists() end)
Players.PlayerRemoving:Connect(function(p) if spectatingPlayer==p then stopSpectating() end; if autoTpEnabled and autoTpTarget==p then stopAutoTp(); autoTpBtn.Text="Auto TP"; autoTpBtn.BackgroundColor3=Color3.fromRGB(255,100,150) end; updateCombatLists() end)

--------------------------------------------------------------
-- DRAG, SHORTCUTS, AUTO-DETECT, CLEANUP
--------------------------------------------------------------
local dragging,dragInput,mousePos,framePos=false,nil,nil,nil
titleBar.InputBegan:Connect(function(input) if input.UserInputType==Enum.UserInputType.MouseButton1 or input.UserInputType==Enum.UserInputType.Touch then dragging=true; mousePos=input.Position; framePos=mainFrame.Position; input.Changed:Connect(function() if input.UserInputState==Enum.UserInputState.End then dragging=false end end) end end)
titleBar.InputChanged:Connect(function(input) if input.UserInputType==Enum.UserInputType.MouseMovement or input.UserInputType==Enum.UserInputType.Touch then dragInput=input end end)
UserInputService.InputChanged:Connect(function(input) if input==dragInput and dragging then local d=input.Position-mousePos; mainFrame.Position=UDim2.new(framePos.X.Scale,framePos.X.Offset+d.X,framePos.Y.Scale,framePos.Y.Offset+d.Y) end end)

UserInputService.InputBegan:Connect(function(input,gp) if gp then return end
    if input.KeyCode==Enum.KeyCode.F2 then mainFrame.Visible=not mainFrame.Visible end
    if input.KeyCode==Enum.KeyCode.F3 then if currentScreen=="billboard" then scanAndPopulate() end end
    if input.KeyCode==Enum.KeyCode.F4 then if currentScreen=="billboard" and selectedBillboard then safeCall(function() attemptServerChange(selectedBillboard,"Enabled",not selectedBillboard.Enabled,analysisCache[selectedBillboard]) end) end end
    if input.KeyCode==Enum.KeyCode.F5 then switchScreen() end
end)

local autoConn
safeCall(function() autoConn=game.DescendantAdded:Connect(function(d)
    if not d:IsA("BillboardGui") then return end
    if isChatBubble(d) then return end
    if isScanActive then return end
    for _,bb in ipairs(detectedBillboards) do if bb==d then return end end
    table.insert(detectedBillboards, d)
    task.defer(function() task.wait(0.1); safeCall(function() ultraAnalyze(d) end) end)
end) end)

safeCall(function() game.DescendantRemoving:Connect(function(d) safeCall(function() if d:IsA("BillboardGui") then for i,bb in ipairs(detectedBillboards) do if bb==d then table.remove(detectedBillboards,i); if selectedBillboard==d then selectedBillboard=nil end; break end end end end) end) end)

screenGui.Destroying:Connect(function() safeCall(function()
    for _,watchers in pairs(activeWatchers) do for _,c in ipairs(watchers) do safeCall(function() c:Disconnect() end) end end
    activeWatchers={}; if autoConn then autoConn:Disconnect() end; stopFlying(); stopAirball(); stopAutoTp()
end) end)


--------------------------------------------------------------
-- COMBAT SECONDARY SCREEN
--------------------------------------------------------------
;(function() -- IIFE scope: resets local register count for CS2
combatSecScreen = Instance.new("Frame", mainFrame)
combatSecScreen.Name = "CS2"
combatSecScreen.Size = UDim2.new(1,-16,1,-38)
combatSecScreen.Position = UDim2.new(0,8,0,34)
combatSecScreen.BackgroundTransparency = 1
combatSecScreen.Visible = false

-- State table for all CS2 settings
local CS2 = {
    -- Aimlock
    aimlockEnabled=false, aimlockFOV=120, aimlockSmoothing=0.15, aimlockPrediction=0.08,
    aimlockAutoPred=true, aimlockTeamCheck=true, aimlockNPCCheck=true, aimlockTarget="Closest to Mouse",
    aimlockPart="Head", aimlockKey="Q",

    -- Triggerbot
    triggerbotEnabled=false, triggerbotDelay=0.05, triggerbotFOV=8, triggerbotTeamCheck=true,
    triggerbotNPCCheck=true, triggerbotSilent=false,

    -- Silent Aim
    silentEnabled=false, silentFOV=100, silentPart="Head", silentTeamCheck=true,
    silentNPCCheck=true, silentRigCheck=true, silentStrength=1.0,

    -- ESP
    espEnabled=false, espBoxes=true, espNames=true, espHealth=true, espDistance=true,
    espTracers=false, espChams=false, espSkeletons=false, espTeamCheck=false,
    espMaxDist=500, espBoxColor={r=255,g=0,b=0}, espTeamColor={r=0,g=255,b=0},

    -- Velocity / Speed
    speedEnabled=false, speedValue=16, speedMode="WalkSpeed", noclipEnabled=false,
    infiniteJumpEnabled=false,

    -- Hitbox Expander
    hitboxEnabled=false, hitboxSize=6, hitboxNPCCheck=true, hitboxTeamCheck=true,
    hitboxPart="HumanoidRootPart", hitboxVisible=false,

    -- Target Aimbot (lock + track)
    targetEnabled=false, targetFOV=80, targetSmoothing=0.1, targetPred=0.06,
    targetPart="Head", targetKey="E", targetTeamCheck=true, targetNPCCheck=true,
    targetShowLine=false,

    -- Visuals
    fullbrightEnabled=false, noFogEnabled=false, origFogEnd=nil, origFogColor=nil,
    origAmbient=nil, origBrightness=nil,
}

-- Active connections for CS2 loops
local cs2Connections = {}

local function cs2Disconnect()
    for k,c in pairs(cs2Connections) do pcall(function() c:Disconnect() end); cs2Connections[k]=nil end
end

-- Helper: get valid targets (players only for now, with checks)
local function getTargets()
    local targets = {}
    local myChar = player.Character
    for _,p in ipairs(Players:GetPlayers()) do
        if p ~= player then
            if CS2.aimlockTeamCheck and p.Team == player.Team then continue end
            if p.Character then
                local hum = p.Character:FindFirstChildOfClass("Humanoid")
                if hum and hum.Health > 0 then
                    table.insert(targets, p)
                end
            end
        end
    end
    -- NPC check - also add NPCs if toggled off
    if not CS2.aimlockNPCCheck then
        for _,v in ipairs(workspace:GetDescendants()) do
            if v:IsA("Humanoid") and v.Health > 0 then
                local char = v.Parent
                if char and not Players:GetPlayerFromCharacter(char) then
                    table.insert(targets, {Character=char, IsNPC=true})
                end
            end
        end
    end
    return targets
end

local function getClosestToCrosshair(fovRadius, partName)
    local best, bestDist = nil, math.huge
    local screenCenter = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)
    for _,p in ipairs(Players:GetPlayers()) do
        if p == player then continue end
        if CS2.aimlockTeamCheck and p.Team == player.Team then continue end
        local char = p.Character
        if not char then continue end
        local hum = char:FindFirstChildOfClass("Humanoid")
        if not hum or hum.Health <= 0 then continue end
        local part = char:FindFirstChild(partName or "Head") or char:FindFirstChild("HumanoidRootPart")
        if not part then continue end
        local pos, onScreen = Camera:WorldToViewportPoint(part.Position)
        if not onScreen then continue end
        local dist = (Vector2.new(pos.X, pos.Y) - screenCenter).Magnitude
        if dist < fovRadius and dist < bestDist then
            best = part; bestDist = dist
        end
    end
    -- NPC sweep if NPC check OFF
    if not CS2.aimlockNPCCheck then
        for _,v in ipairs(workspace:GetDescendants()) do
            if v:IsA("Humanoid") and v.Health > 0 then
                local char = v.Parent
                if not Players:GetPlayerFromCharacter(char) then
                    local part = char:FindFirstChild(partName or "Head") or char:FindFirstChild("HumanoidRootPart")
                    if part then
                        local pos, onScreen = Camera:WorldToViewportPoint(part.Position)
                        if onScreen then
                            local dist = (Vector2.new(pos.X, pos.Y) - Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)).Magnitude
                            if dist < fovRadius and dist < bestDist then best=part; bestDist=dist end
                        end
                    end
                end
            end
        end
    end
    return best
end

-- Target selection by mode (used by aimlock)
local function getAimlockTarget(fovRadius, partName, mode)
    if not mode or mode == "Closest to Mouse" then
        return getClosestToCrosshair(fovRadius, partName)
    end
    local best, bestVal = nil, nil
    local screenCenter = Vector2.new(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2)
    local myHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    for _,p in ipairs(Players:GetPlayers()) do
        if p == player then continue end
        if CS2.aimlockTeamCheck and p.Team == player.Team then continue end
        local char = p.Character
        if not char then continue end
        local hum = char:FindFirstChildOfClass("Humanoid")
        if not hum or hum.Health <= 0 then continue end
        local part = char:FindFirstChild(partName or "Head") or char:FindFirstChild("HumanoidRootPart")
        if not part then continue end
        local pos, onScreen = Camera:WorldToViewportPoint(part.Position)
        if not onScreen then continue end
        local screenDist = (Vector2.new(pos.X, pos.Y) - screenCenter).Magnitude
        if screenDist > fovRadius then continue end
        if mode == "Nearest" then
            local dist = myHRP and (part.Position - myHRP.Position).Magnitude or screenDist
            if not bestVal or dist < bestVal then best = part; bestVal = dist end
        elseif mode == "LowestHP" then
            if not bestVal or hum.Health < bestVal then best = part; bestVal = hum.Health end
        elseif mode == "HighestHP" then
            if not bestVal or hum.Health > bestVal then best = part; bestVal = hum.Health end
        elseif mode == "Random" then
            best = part
        end
    end
    return best
end

local function predictPosition(part, ahead)
    if not part or not part.Parent then return part and part.Position end
    local vel = Vector3.new(0,0,0)
    pcall(function()
        local hrp = part.Parent:FindFirstChild("HumanoidRootPart") or part.Parent:FindFirstChild("Torso")
        if hrp then vel = hrp.AssemblyLinearVelocity end
    end)
    return part.Position + vel * ahead
end

-- AIMLOCK LOOP
local function startAimlock()
    if cs2Connections.aimlock then cs2Connections.aimlock:Disconnect() end
    cs2Connections.aimlock = RunService.Heartbeat:Connect(function()
        if not CS2.aimlockEnabled then return end
        if not UserInputService:IsKeyDown(Enum.KeyCode[CS2.aimlockKey] or Enum.KeyCode.Q) then return end
        local target = getAimlockTarget(CS2.aimlockFOV, CS2.aimlockPart, CS2.aimlockTarget)
        if not target then return end
        local pred = CS2.aimlockAutoPred
            and predictPosition(target, CS2.aimlockPrediction)
            or target.Position
        local targetCF = CFrame.lookAt(Camera.CFrame.Position, pred)
        Camera.CFrame = Camera.CFrame:Lerp(targetCF, 1 - CS2.aimlockSmoothing)
    end)
end

-- TRIGGERBOT LOOP
local function startTriggerbot()
    if cs2Connections.trigger then cs2Connections.trigger:Disconnect() end
    cs2Connections.trigger = RunService.Heartbeat:Connect(function()
        if not CS2.triggerbotEnabled then return end
        local target = getClosestToCrosshair(CS2.triggerbotFOV, "HumanoidRootPart")
        if not target then return end
        -- Simulate mouse click
        pcall(function()
            local vim = game:GetService("VirtualInputManager")
            vim:SendMouseButtonEvent(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2, 0, true, game, 0)
            task.defer(function() pcall(function() vim:SendMouseButtonEvent(Camera.ViewportSize.X/2, Camera.ViewportSize.Y/2, 0, false, game, 0) end) end)
        end)
        -- Fallback: fire tool remotes
        pcall(function()
            local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
            if tool then
                tool:Activate()
            end
        end)
    end)
end

-- SILENT AIM
local silentConn
local function startSilentAim()
    if silentConn then silentConn:Disconnect() end
    silentConn = nil
    if not CS2.silentEnabled then return end
    -- Detect rig type and handle multiple game types (Arsenal, Rivals, R6, R15)
    local function getTargetPart()
        return getClosestToCrosshair(CS2.silentFOV, CS2.silentPart)
    end
    -- Hook projectile/ray remotes by patching WorldToViewportPoint approach
    -- We intercept Camera CFrame queries during the hit detection frame
    local origGetMouse = nil
    pcall(function()
        local mt = getrawmetatable(player)
        if mt then return end
    end)
    -- Primary method: override the mouse hit/target via newcclosure on __index
    pcall(function()
        local mt = getrawmetatable(workspace.CurrentCamera)
        if not mt or not setreadonly then return end
        setreadonly(mt, false)
        local oldIndex = rawget(mt, "__index")
        silentConn = {Disconnect=function()
            if oldIndex then
                pcall(function() setreadonly(mt, false); rawset(mt, "__index", oldIndex); setreadonly(mt, true) end)
            end
        end}
        local patchedIndex = newcclosure(function(self, key)
            if key == "CFrame" and CS2.silentEnabled then
                local target = getTargetPart()
                if target then
                    local pred = CS2.silentRigCheck
                        and predictPosition(target, CS2.aimlockPrediction)
                        or target.Position
                    return CFrame.lookAt(self.CFrame.Position, pred)
                end
            end
            return oldIndex(self, key)
        end)
        rawset(mt, "__index", patchedIndex)
        setreadonly(mt, true)
    end)
end

-- ESP DRAWING
local espFolder = Instance.new("Folder"); espFolder.Name = "TempestESP"; espFolder.Parent = playerGui
local espHighlights = {}
local espBillboards = {}

local function clearESP()
    for _,h in pairs(espHighlights) do pcall(function() h:Destroy() end) end; espHighlights={}
    for _,b in pairs(espBillboards) do pcall(function() b:Destroy() end) end; espBillboards={}
end

local function applyESP(p)
    if not p.Character then return end
    -- Highlight (chams / box approximation via SelectionBox or Highlight)
    if CS2.espChams or CS2.espBoxes then
        local hi = espHighlights[p]
        if not hi then
            hi = Instance.new("Highlight"); hi.Parent = espFolder
            hi.Adornee = p.Character
            hi.FillTransparency = CS2.espChams and 0.5 or 1
            hi.OutlineTransparency = CS2.espBoxes and 0 or 1
            hi.OutlineColor = CS2.espTeamCheck and (p.Team==player.Team) and Color3.fromRGB(CS2.espTeamColor.r,CS2.espTeamColor.g,CS2.espTeamColor.b) or Color3.fromRGB(CS2.espBoxColor.r,CS2.espBoxColor.g,CS2.espBoxColor.b)
            hi.FillColor = Color3.fromRGB(CS2.espBoxColor.r, CS2.espBoxColor.g, CS2.espBoxColor.b)
            espHighlights[p] = hi
        else
            hi.Adornee = p.Character
        end
    end
    -- Billboard for name/health/distance
    if CS2.espNames or CS2.espHealth or CS2.espDistance then
        local bb = espBillboards[p]
        if not bb then
            bb = Instance.new("BillboardGui"); bb.Parent = espFolder
            bb.Size = UDim2.new(0,140,0,40); bb.StudsOffset = Vector3.new(0,3,0)
            bb.AlwaysOnTop = true; bb.MaxDistance = CS2.espMaxDist
            local lbl = Instance.new("TextLabel",bb); lbl.Name="Info"; lbl.Size=UDim2.new(1,0,1,0); lbl.BackgroundTransparency=1; lbl.TextColor3=Color3.fromRGB(255,255,255); lbl.TextSize=11; lbl.Font=Enum.Font.GothamBold; lbl.TextStrokeTransparency=0.5; lbl.TextStrokeColor3=Color3.fromRGB(0,0,0); lbl.TextWrapped=true
            espBillboards[p] = bb
        end
        local hrp = p.Character:FindFirstChild("HumanoidRootPart")
        local hum = p.Character:FindFirstChildOfClass("Humanoid")
        if hrp then bb.Adornee = hrp end
        local parts = {}
        if CS2.espNames then table.insert(parts, p.DisplayName) end
        if CS2.espHealth and hum then table.insert(parts, math.floor(hum.Health).."hp") end
        if CS2.espDistance and hrp then
            local myHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
            if myHRP then table.insert(parts, math.floor((hrp.Position-myHRP.Position).Magnitude).."m") end
        end
        local lbl = bb:FindFirstChild("Info")
        if lbl then lbl.Text = table.concat(parts," | ") end
    end
end

local function updateESP()
    if not CS2.espEnabled then clearESP(); return end
    for _,p in ipairs(Players:GetPlayers()) do
        if p ~= player then
            if CS2.espTeamCheck and p.Team == player.Team then
                if espHighlights[p] then espHighlights[p]:Destroy(); espHighlights[p]=nil end
                if espBillboards[p] then espBillboards[p]:Destroy(); espBillboards[p]=nil end
            else
                pcall(function() applyESP(p) end)
            end
        end
    end
    -- Remove stale
    for p,h in pairs(espHighlights) do if not p.Character then h:Destroy(); espHighlights[p]=nil end end
    for p,b in pairs(espBillboards) do if not p.Character then b:Destroy(); espBillboards[p]=nil end end
end

cs2Connections.esp = RunService.Heartbeat:Connect(function()
    if CS2.espEnabled then pcall(updateESP) end
end)

-- SPEED / NOCLIP / INFINITE JUMP
local infJumpConn
local function applyInfiniteJump(on)
    if infJumpConn then infJumpConn:Disconnect(); infJumpConn=nil end
    if not on then return end
    infJumpConn = UserInputService.JumpRequest:Connect(function()
        local char = player.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
        end
    end)
end

local function applySpeed(on)
    local char = player.Character
    if not char then return end
    local hum = char:FindFirstChildOfClass("Humanoid")
    if not hum then return end
    if on then
        if CS2.speedMode == "WalkSpeed" then hum.WalkSpeed = CS2.speedValue
        elseif CS2.speedMode == "JumpPower" then hum.JumpPower = CS2.speedValue end
    else
        hum.WalkSpeed = 16; hum.JumpPower = 50
    end
end

local noclipConn
local function applyNoclip(on)
    if noclipConn then noclipConn:Disconnect(); noclipConn=nil end
    if not on then return end
    noclipConn = RunService.Stepped:Connect(function()
        local char = player.Character
        if not char then return end
        for _,p in ipairs(char:GetDescendants()) do
            if p:IsA("BasePart") then p.CanCollide = false end
        end
    end)
end

player.CharacterAdded:Connect(function()
    task.wait(1)
    if CS2.speedEnabled then applySpeed(true) end
    if CS2.infiniteJumpEnabled then applyInfiniteJump(true) end
    if CS2.noclipEnabled then applyNoclip(true) end
end)

-- HITBOX EXPANDER
local hitboxStore = {}
local hitboxVisuals = {}
local function clearHitboxVisuals() for _,v in pairs(hitboxVisuals) do pcall(function() v:Destroy() end) end; hitboxVisuals = {} end
local function applyHitbox(on)
    for char, data in pairs(hitboxStore) do pcall(function() for partName, origSize in pairs(data) do local p = char:FindFirstChild(partName); if p then p.Size = origSize end end end) end
    hitboxStore = {}; clearHitboxVisuals()
    if not on then return end
    local expandParts = CS2.hitboxPart == "All" and {"HumanoidRootPart","Head","Torso","UpperTorso"} or {CS2.hitboxPart}
    for _,p in ipairs(Players:GetPlayers()) do
        if p == player then continue end
        if CS2.hitboxTeamCheck and p.Team == player.Team then continue end
        local char = p.Character; if not char then continue end
        local hum = char:FindFirstChildOfClass("Humanoid"); if not hum or hum.Health <= 0 then continue end
        hitboxStore[char] = {}
        for _,pn in ipairs(expandParts) do
            local part = char:FindFirstChild(pn)
            if part and part:IsA("BasePart") then
                hitboxStore[char][pn] = part.Size
                pcall(function() part.Size = Vector3.new(CS2.hitboxSize, CS2.hitboxSize, CS2.hitboxSize) end)
                if CS2.hitboxVisible then pcall(function()
                    local box = Instance.new("SelectionBox"); box.Adornee = part; box.Color3 = Color3.fromRGB(255, 50, 50)
                    box.LineThickness = 0.03; box.Transparency = 0.5; box.SurfaceTransparency = 0.85
                    box.SurfaceColor3 = Color3.fromRGB(255, 0, 0); box.Parent = playerGui; table.insert(hitboxVisuals, box)
                end) end
            end
        end
    end
end

cs2Connections.hitbox = RunService.Heartbeat:Connect(function()
    if CS2.hitboxEnabled then pcall(function() applyHitbox(true) end) end
end)

-- TARGET AIMBOT (separate from aimlock - keeps locked until dead)
local targetLocked = nil
local targetLine, targetLineAtt0, targetLineAtt1 = nil, nil, nil
local function clearTargetLine() pcall(function() if targetLine then targetLine:Destroy(); targetLine=nil end end); pcall(function() if targetLineAtt0 then targetLineAtt0:Destroy(); targetLineAtt0=nil end end); pcall(function() if targetLineAtt1 then targetLineAtt1:Destroy(); targetLineAtt1=nil end end) end
local function updateTargetLine()
    if not CS2.targetShowLine or not targetLocked or not targetLocked.Parent then clearTargetLine(); return end
    local myHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart"); if not myHRP then clearTargetLine(); return end
    pcall(function()
        if not targetLine then
            targetLineAtt0 = Instance.new("Attachment"); targetLineAtt0.Parent = workspace.Terrain
            targetLineAtt1 = Instance.new("Attachment"); targetLineAtt1.Parent = workspace.Terrain
            targetLine = Instance.new("Beam"); targetLine.Attachment0 = targetLineAtt0; targetLine.Attachment1 = targetLineAtt1
            targetLine.Color = ColorSequence.new(Color3.fromRGB(255, 50, 200)); targetLine.Width0 = 0.15; targetLine.Width1 = 0.15
            targetLine.FaceCamera = true; targetLine.Transparency = NumberSequence.new(0.3); targetLine.Parent = workspace.Terrain
        end
        targetLineAtt0.WorldPosition = myHRP.Position; targetLineAtt1.WorldPosition = targetLocked.Position
    end)
end
local function startTargetAimbot()
    if cs2Connections.target then cs2Connections.target:Disconnect() end
    cs2Connections.target = RunService.Heartbeat:Connect(function()
        if not CS2.targetEnabled then clearTargetLine(); targetLocked=nil; return end
        if not UserInputService:IsKeyDown(Enum.KeyCode[CS2.targetKey] or Enum.KeyCode.E) then
            clearTargetLine(); targetLocked = nil; return
        end
        if targetLocked and targetLocked.Parent then
            local hum = targetLocked.Parent:FindFirstChildOfClass("Humanoid")
            if not hum or hum.Health <= 0 then targetLocked = nil; clearTargetLine() end
        else targetLocked = nil; clearTargetLine() end
        if not targetLocked then targetLocked = getClosestToCrosshair(CS2.targetFOV, CS2.targetPart) end
        if not targetLocked then clearTargetLine(); return end
        local pred = predictPosition(targetLocked, CS2.targetPred)
        if pred then
            local targetCF = CFrame.lookAt(Camera.CFrame.Position, pred)
            Camera.CFrame = Camera.CFrame:Lerp(targetCF, 1 - CS2.targetSmoothing)
        end
        updateTargetLine()
    end)
end

-- VISUALS: Fullbright / NoFog
local function applyFullbright(on)
    if on then
        CS2.origAmbient = Lighting.Ambient
        CS2.origBrightness = Lighting.Brightness
        Lighting.Ambient = Color3.fromRGB(255,255,255)
        Lighting.Brightness = 2
        Lighting.GlobalShadows = false
        Lighting.FogEnd = 1e6
    else
        if CS2.origAmbient then Lighting.Ambient = CS2.origAmbient end
        if CS2.origBrightness then Lighting.Brightness = CS2.origBrightness end
        Lighting.GlobalShadows = true
        if CS2.origFogEnd then Lighting.FogEnd = CS2.origFogEnd end
    end
end

local function applyNoFog(on)
    if on then
        CS2.origFogEnd = Lighting.FogEnd
        CS2.origFogColor = Lighting.FogColor
        Lighting.FogEnd = 1e6
        Lighting.FogStart = 1e6
    else
        if CS2.origFogEnd then Lighting.FogEnd = CS2.origFogEnd end
        if CS2.origFogColor then Lighting.FogColor = CS2.origFogColor end
    end
end

-- Start loops
startAimlock(); startTriggerbot(); startTargetAimbot()

--------------------------------------------------------------
-- CS2 GUI LAYOUT
--------------------------------------------------------------
-- Left sidebar: category nav tabs
local cs2Left = Instance.new("Frame", combatSecScreen)
cs2Left.Size = UDim2.new(0,120,1,0); cs2Left.BackgroundColor3=Color3.fromRGB(30,30,32); cs2Left.BorderSizePixel=0
Instance.new("UICorner",cs2Left).CornerRadius=UDim.new(0,4)

local cs2Right = Instance.new("ScrollingFrame", combatSecScreen)
cs2Right.Size = UDim2.new(1,-128,1,0); cs2Right.Position = UDim2.new(0,128,0,0)
cs2Right.BackgroundColor3=Color3.fromRGB(37,37,38); cs2Right.BorderSizePixel=0
cs2Right.ScrollBarThickness=6; cs2Right.ScrollBarImageColor3=Color3.fromRGB(100,100,100)
cs2Right.CanvasSize=UDim2.new(0,0,0,0)
Instance.new("UICorner",cs2Right).CornerRadius=UDim.new(0,4)
local cs2RightLayout = Instance.new("UIListLayout",cs2Right)
cs2RightLayout.SortOrder=Enum.SortOrder.LayoutOrder; cs2RightLayout.Padding=UDim.new(0,6)
local cs2RPad = Instance.new("UIPadding",cs2Right)
cs2RPad.PaddingLeft=UDim.new(0,8); cs2RPad.PaddingRight=UDim.new(0,8); cs2RPad.PaddingTop=UDim.new(0,6); cs2RPad.PaddingBottom=UDim.new(0,6)

cs2RightLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    cs2Right.CanvasSize = UDim2.new(0,0,0,cs2RightLayout.AbsoluteContentSize.Y+16)
end)

-- Nav tabs on left
local cs2NavLayout = Instance.new("UIListLayout",cs2Left)
cs2NavLayout.SortOrder=Enum.SortOrder.LayoutOrder; cs2NavLayout.Padding=UDim.new(0,2)
local cs2NavPad = Instance.new("UIPadding",cs2Left)
cs2NavPad.PaddingLeft=UDim.new(0,5); cs2NavPad.PaddingRight=UDim.new(0,5); cs2NavPad.PaddingTop=UDim.new(0,8)

local CS2_CATEGORIES = {
    {id="aimlock",   label="ğŸ¯ Aimlock",    color=Color3.fromRGB(255,80,80)},
    {id="trigger",   label="âš¡ Triggerbot",  color=Color3.fromRGB(255,160,0)},
    {id="silent",    label="ğŸ‘» Silent Aim",  color=Color3.fromRGB(100,200,255)},
    {id="target",    label="ğŸ”’ Target AB",   color=Color3.fromRGB(255,100,200)},
    {id="hitbox",    label="ğŸ“¦ Hitbox",      color=Color3.fromRGB(200,255,100)},
    {id="esp",       label="ğŸ‘ ESP",         color=Color3.fromRGB(0,220,180)},
    {id="movement",  label="ğŸƒ Movement",    color=Color3.fromRGB(100,180,255)},
    {id="visuals",   label="ğŸŒŸ Visuals",     color=Color3.fromRGB(255,220,80)},
}

local cs2NavBtns = {}
local cs2ActiveCat = "aimlock"
local cs2Sections = {} -- category id -> frame

-- Section container helper: create a section frame with header
local function cs2Section(catId, title, color)
    local f = Instance.new("Frame", cs2Right)
    f.Name = catId; f.BackgroundTransparency=1; f.BorderSizePixel=0
    f.AutomaticSize = Enum.AutomaticSize.Y
    f.Size = UDim2.new(1,0,0,0)
    f.Visible = false; f.LayoutOrder = 0
    local layout = Instance.new("UIListLayout",f)
    layout.SortOrder=Enum.SortOrder.LayoutOrder; layout.Padding=UDim.new(0,5)
    -- Header
    local hdr = Instance.new("Frame",f); hdr.Size=UDim2.new(1,0,0,26); hdr.BackgroundColor3=Color3.fromRGB(30,30,32); hdr.BorderSizePixel=0; Instance.new("UICorner",hdr).CornerRadius=UDim.new(0,4)
    local accent = Instance.new("Frame",hdr); accent.Size=UDim2.new(0,3,1,0); accent.BackgroundColor3=color; accent.BorderSizePixel=0; Instance.new("UICorner",accent).CornerRadius=UDim.new(0,2)
    local hl = Instance.new("TextLabel",hdr); hl.Size=UDim2.new(1,-10,1,0); hl.Position=UDim2.new(0,8,0,0); hl.BackgroundTransparency=1; hl.Text="// "..title; hl.TextColor3=color; hl.TextSize=12; hl.Font=Enum.Font.GothamBold; hl.TextXAlignment=Enum.TextXAlignment.Left
    cs2Sections[catId] = f
    return f, layout
end

-- Widget builders
local function cs2Toggle(parent, label, getter, setter, subLabel)
    local f = Instance.new("Frame",parent); f.Size=UDim2.new(1,0,0,36); f.BackgroundColor3=Color3.fromRGB(45,45,48); f.BorderSizePixel=0; Instance.new("UICorner",f).CornerRadius=UDim.new(0,4)
    local lbl = Instance.new("TextLabel",f); lbl.Size=UDim2.new(1,-60,1,0); lbl.Position=UDim2.new(0,10,0,0); lbl.BackgroundTransparency=1; lbl.Text=label; lbl.TextColor3=Color3.fromRGB(220,220,220); lbl.TextSize=12; lbl.Font=Enum.Font.Gotham; lbl.TextXAlignment=Enum.TextXAlignment.Left
    if subLabel then lbl.Text=label.."\n"..subLabel; lbl.TextSize=10 end
    local tog = Instance.new("TextButton",f); tog.Size=UDim2.new(0,46,0,22); tog.Position=UDim2.new(1,-52,0.5,-11); tog.BorderSizePixel=0; tog.Font=Enum.Font.GothamBold; tog.TextSize=10; tog.TextColor3=Color3.fromRGB(255,255,255)
    Instance.new("UICorner",tog).CornerRadius=UDim.new(1,0)
    local function refresh() local on=getter(); tog.Text=on and "ON" or "OFF"; tog.BackgroundColor3=on and Color3.fromRGB(0,200,100) or Color3.fromRGB(80,80,85) end
    refresh()
    tog.MouseButton1Click:Connect(function() setter(not getter()); refresh() end)
    return f
end

local function cs2Slider(parent, label, minV, maxV, getter, setter, fmt, step)
    step = step or 1
    local h = 52
    local f = Instance.new("Frame",parent); f.Size=UDim2.new(1,0,0,h); f.BackgroundColor3=Color3.fromRGB(45,45,48); f.BorderSizePixel=0; Instance.new("UICorner",f).CornerRadius=UDim.new(0,4)
    local lbl = Instance.new("TextLabel",f); lbl.Size=UDim2.new(0.7,0,0,20); lbl.Position=UDim2.new(0,10,0,4); lbl.BackgroundTransparency=1; lbl.Text=label; lbl.TextColor3=Color3.fromRGB(200,200,200); lbl.TextSize=11; lbl.Font=Enum.Font.Gotham; lbl.TextXAlignment=Enum.TextXAlignment.Left
    local valLbl = Instance.new("TextLabel",f); valLbl.Size=UDim2.new(0.28,0,0,20); valLbl.Position=UDim2.new(0.72,0,0,4); valLbl.BackgroundTransparency=1; valLbl.TextColor3=Color3.fromRGB(0,200,150); valLbl.TextSize=11; valLbl.Font=Enum.Font.GothamBold; valLbl.TextXAlignment=Enum.TextXAlignment.Right
    local track = Instance.new("Frame",f); track.Size=UDim2.new(1,-20,0,6); track.Position=UDim2.new(0,10,0,30); track.BackgroundColor3=Color3.fromRGB(60,60,65); track.BorderSizePixel=0; Instance.new("UICorner",track).CornerRadius=UDim.new(1,0)
    local fill = Instance.new("Frame",track); fill.Size=UDim2.new(0,0,1,0); fill.BackgroundColor3=Color3.fromRGB(0,180,255); fill.BorderSizePixel=0; Instance.new("UICorner",fill).CornerRadius=UDim.new(1,0)
    local knob = Instance.new("Frame",track); knob.Size=UDim2.new(0,14,0,14); knob.AnchorPoint=Vector2.new(0.5,0.5); knob.BackgroundColor3=Color3.fromRGB(255,255,255); knob.BorderSizePixel=0; Instance.new("UICorner",knob).CornerRadius=UDim.new(1,0)
    local function refresh()
        local v=getter(); local t=(v-minV)/(maxV-minV)
        fill.Size=UDim2.new(t,0,1,0)
        knob.Position=UDim2.new(t,0,0.5,0)
        valLbl.Text=(fmt and string.format(fmt,v)) or tostring(v)
    end
    refresh()
    local draggingSlider=false
    knob.InputBegan:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then draggingSlider=true end end)
    UserInputService.InputEnded:Connect(function(i) if i.UserInputType==Enum.UserInputType.MouseButton1 then draggingSlider=false end end)
    UserInputService.InputChanged:Connect(function(i)
        if draggingSlider and i.UserInputType==Enum.UserInputType.MouseMovement then
            local tAbs = track.AbsolutePosition; local tSize = track.AbsoluteSize
            local t = math.clamp((i.Position.X - tAbs.X)/tSize.X, 0, 1)
            local raw = minV + t*(maxV-minV)
            local v = step < 1 and math.floor(raw/step+0.5)*step or math.floor(raw/step+0.5)*step
            setter(v); refresh()
        end
    end)
    track.InputBegan:Connect(function(i)
        if i.UserInputType==Enum.UserInputType.MouseButton1 then
            local tAbs=track.AbsolutePosition; local tSize=track.AbsoluteSize
            local t=math.clamp((i.Position.X-tAbs.X)/tSize.X,0,1)
            local raw=minV+t*(maxV-minV)
            local v=step<1 and math.floor(raw/step+0.5)*step or math.floor(raw/step+0.5)*step
            setter(v); refresh()
        end
    end)
    return f
end

local function cs2Dropdown(parent, label, options, getter, setter)
    local expanded = false
    local f = Instance.new("Frame",parent); f.BackgroundTransparency=1; f.Size=UDim2.new(1,0,0,36); f.BorderSizePixel=0; f.ClipsDescendants=false
    local layout = Instance.new("UIListLayout",f); layout.SortOrder=Enum.SortOrder.LayoutOrder; layout.Padding=UDim.new(0,2)
    local header = Instance.new("Frame",f); header.Size=UDim2.new(1,0,0,36); header.BackgroundColor3=Color3.fromRGB(45,45,48); header.BorderSizePixel=0; Instance.new("UICorner",header).CornerRadius=UDim.new(0,4)
    local lbl = Instance.new("TextLabel",header); lbl.Size=UDim2.new(0.55,0,1,0); lbl.Position=UDim2.new(0,10,0,0); lbl.BackgroundTransparency=1; lbl.Text=label; lbl.TextColor3=Color3.fromRGB(200,200,200); lbl.TextSize=11; lbl.Font=Enum.Font.Gotham; lbl.TextXAlignment=Enum.TextXAlignment.Left
    local selBtn = Instance.new("TextButton",header); selBtn.Size=UDim2.new(0.42,0,0,26); selBtn.Position=UDim2.new(0.56,0,0.5,-13); selBtn.BackgroundColor3=Color3.fromRGB(30,30,32); selBtn.BorderSizePixel=0; selBtn.TextColor3=Color3.fromRGB(0,200,150); selBtn.TextSize=11; selBtn.Font=Enum.Font.GothamBold; Instance.new("UICorner",selBtn).CornerRadius=UDim.new(0,4)
    local dropList = Instance.new("Frame",f); dropList.BackgroundColor3=Color3.fromRGB(30,30,32); dropList.BorderSizePixel=0; dropList.Size=UDim2.new(1,0,0,0); dropList.Visible=false; dropList.ZIndex=20; Instance.new("UICorner",dropList).CornerRadius=UDim.new(0,4)
    local dropLayout = Instance.new("UIListLayout",dropList); dropLayout.SortOrder=Enum.SortOrder.LayoutOrder; dropLayout.Padding=UDim.new(0,2)
    local dropPad = Instance.new("UIPadding",dropList); dropPad.PaddingLeft=UDim.new(0,4); dropPad.PaddingRight=UDim.new(0,4); dropPad.PaddingTop=UDim.new(0,4); dropPad.PaddingBottom=UDim.new(0,4)
    local function refresh() selBtn.Text=getter().." â–¾" end; refresh()
    for _,opt in ipairs(options) do
        local ob = Instance.new("TextButton",dropList); ob.Size=UDim2.new(1,0,0,22); ob.BackgroundColor3=Color3.fromRGB(45,45,48); ob.BorderSizePixel=0; ob.Text=opt; ob.TextColor3=Color3.fromRGB(220,220,220); ob.TextSize=11; ob.Font=Enum.Font.Gotham; Instance.new("UICorner",ob).CornerRadius=UDim.new(0,3); ob.ZIndex=21
        ob.MouseButton1Click:Connect(function() setter(opt); refresh(); expanded=false; dropList.Visible=false; f.Size=UDim2.new(1,0,0,36) end)
    end
    selBtn.MouseButton1Click:Connect(function()
        expanded = not expanded
        dropList.Visible = expanded
        if expanded then
            local dh = #options*26+8; dropList.Size=UDim2.new(1,0,0,dh); f.Size=UDim2.new(1,0,0,36+dh+2)
        else f.Size=UDim2.new(1,0,0,36) end
    end)
    return f
end

local function cs2Separator(parent, text)
    local f = Instance.new("Frame",parent); f.Size=UDim2.new(1,0,0,18); f.BackgroundTransparency=1; f.BorderSizePixel=0
    local l = Instance.new("TextLabel",f); l.Size=UDim2.new(1,0,1,0); l.BackgroundTransparency=1; l.Text=text or ""; l.TextColor3=Color3.fromRGB(100,100,105); l.TextSize=10; l.Font=Enum.Font.GothamBold; l.TextXAlignment=Enum.TextXAlignment.Left
    local line = Instance.new("Frame",f); line.Size=UDim2.new(1,0,0,1); line.Position=UDim2.new(0,0,0.5,0); line.BackgroundColor3=Color3.fromRGB(55,55,60); line.BorderSizePixel=0; line.ZIndex=f.ZIndex-1
    return f
end

local function cs2ColorRow(parent, label, tbl, key)
    local f = Instance.new("Frame",parent); f.Size=UDim2.new(1,0,0,36); f.BackgroundColor3=Color3.fromRGB(45,45,48); f.BorderSizePixel=0; Instance.new("UICorner",f).CornerRadius=UDim.new(0,4)
    local lbl = Instance.new("TextLabel",f); lbl.Size=UDim2.new(0.4,0,1,0); lbl.Position=UDim2.new(0,10,0,0); lbl.BackgroundTransparency=1; lbl.Text=label; lbl.TextColor3=Color3.fromRGB(200,200,200); lbl.TextSize=11; lbl.Font=Enum.Font.Gotham; lbl.TextXAlignment=Enum.TextXAlignment.Left
    local function makeChannel(labelT, xPos, colorKey)
        local box = Instance.new("TextBox",f); box.Size=UDim2.new(0,40,0,22); box.Position=UDim2.new(xPos,0,0.5,-11); box.BackgroundColor3=Color3.fromRGB(30,30,32); box.BorderSizePixel=0; box.Text=tostring(tbl[colorKey]); box.TextColor3=Color3.fromRGB(220,220,220); box.TextSize=10; box.Font=Enum.Font.Code; box.ClearTextOnFocus=false; Instance.new("UICorner",box).CornerRadius=UDim.new(0,3)
        box.FocusLost:Connect(function() local v=tonumber(box.Text); if v then tbl[colorKey]=math.clamp(math.floor(v),0,255) end; box.Text=tostring(tbl[colorKey]) end)
    end
    makeChannel("R",0.42,"r"); makeChannel("G",0.57,"g"); makeChannel("B",0.72,"b")
    local preview = Instance.new("Frame",f); preview.Size=UDim2.new(0,18,0,18); preview.Position=UDim2.new(0.88,0,0.5,-9); preview.BorderSizePixel=0; Instance.new("UICorner",preview).CornerRadius=UDim.new(0,3)
    RunService.Heartbeat:Connect(function() pcall(function() preview.BackgroundColor3=Color3.fromRGB(tbl.r,tbl.g,tbl.b) end) end)
    return f
end

-- Build nav buttons and populate sections
local function cs2ShowCat(catId)
    cs2ActiveCat = catId
    for id,sec in pairs(cs2Sections) do sec.Visible=(id==catId) end
    for _,btn in ipairs(cs2NavBtns) do
        btn.BackgroundColor3 = btn.Name==catId and Color3.fromRGB(0,122,204) or Color3.fromRGB(45,45,50)
    end
    cs2Right.CanvasPosition = Vector2.new(0,0)
end

for i,cat in ipairs(CS2_CATEGORIES) do
    local btn = Instance.new("TextButton",cs2Left)
    btn.Name = cat.id; btn.Size=UDim2.new(1,0,0,34); btn.BackgroundColor3=Color3.fromRGB(45,45,50); btn.BorderSizePixel=0; btn.Text=cat.label; btn.TextColor3=Color3.fromRGB(210,210,215); btn.TextSize=11; btn.Font=Enum.Font.Gotham; btn.TextXAlignment=Enum.TextXAlignment.Left; btn.LayoutOrder=i
    Instance.new("UICorner",btn).CornerRadius=UDim.new(0,4)
    local pad=Instance.new("UIPadding",btn); pad.PaddingLeft=UDim.new(0,8)
    btn.MouseEnter:Connect(function() if btn.Name~=cs2ActiveCat then btn.BackgroundColor3=Color3.fromRGB(55,55,60) end end)
    btn.MouseLeave:Connect(function() if btn.Name~=cs2ActiveCat then btn.BackgroundColor3=Color3.fromRGB(45,45,50) end end)
    btn.MouseButton1Click:Connect(function() cs2ShowCat(cat.id) end)
    table.insert(cs2NavBtns, btn)
end

--------------------------------------------------------------
-- POPULATE SECTIONS
--------------------------------------------------------------

-- AIMLOCK
do
    local sec, lay = cs2Section("aimlock","AIMLOCK",Color3.fromRGB(255,80,80))
    cs2Toggle(sec,"Aimlock Enabled",function() return CS2.aimlockEnabled end,function(v) CS2.aimlockEnabled=v; startAimlock() end)
    cs2Separator(sec,"TARGETING")
    cs2Dropdown(sec,"Target Part",{"Head","HumanoidRootPart","Torso","UpperTorso"},function() return CS2.aimlockPart end,function(v) CS2.aimlockPart=v end)
    cs2Dropdown(sec,"Target Mode",{"Closest to Mouse","Nearest","LowestHP","HighestHP","Random"},function() return CS2.aimlockTarget end,function(v) CS2.aimlockTarget=v end)
    cs2Dropdown(sec,"Hold Key",{"Q","E","R","T","G","X","Z","C","V","F","LeftShift","LeftControl"},function() return CS2.aimlockKey end,function(v) CS2.aimlockKey=v end)
    cs2Separator(sec,"FOV & SMOOTHING")
    cs2Slider(sec,"FOV Radius (px)",10,600,function() return CS2.aimlockFOV end,function(v) CS2.aimlockFOV=v end,"%d px",1)
    cs2Slider(sec,"Smoothing",0.01,0.99,function() return CS2.aimlockSmoothing end,function(v) CS2.aimlockSmoothing=v end,"%.2f",0.01)
    cs2Separator(sec,"PREDICTION")
    cs2Toggle(sec,"Auto Prediction",function() return CS2.aimlockAutoPred end,function(v) CS2.aimlockAutoPred=v end,"Calculates velocity automatically")
    cs2Slider(sec,"Manual Prediction",0,0.5,function() return CS2.aimlockPrediction end,function(v) CS2.aimlockPrediction=v end,"%.3f",0.005)
    cs2Separator(sec,"CHECKS")
    cs2Toggle(sec,"Team Check",function() return CS2.aimlockTeamCheck end,function(v) CS2.aimlockTeamCheck=v end,"Skip teammates")
    cs2Toggle(sec,"NPC Check",function() return CS2.aimlockNPCCheck end,function(v) CS2.aimlockNPCCheck=v end,"Skip non-player characters")
end

-- TRIGGERBOT
do
    local sec, lay = cs2Section("trigger","TRIGGERBOT",Color3.fromRGB(255,160,0))
    cs2Toggle(sec,"Triggerbot Enabled",function() return CS2.triggerbotEnabled end,function(v) CS2.triggerbotEnabled=v; startTriggerbot() end)
    cs2Slider(sec,"FOV Radius (px)",1,200,function() return CS2.triggerbotFOV end,function(v) CS2.triggerbotFOV=v end,"%d px",1)
    cs2Slider(sec,"Shoot Delay (s)",0,0.5,function() return CS2.triggerbotDelay end,function(v) CS2.triggerbotDelay=v end,"%.2fs",0.01)
    cs2Separator(sec,"CHECKS")
    cs2Toggle(sec,"Team Check",function() return CS2.triggerbotTeamCheck end,function(v) CS2.triggerbotTeamCheck=v end)
    cs2Toggle(sec,"NPC Check",function() return CS2.triggerbotNPCCheck end,function(v) CS2.triggerbotNPCCheck=v end)
end

-- SILENT AIM
do
    local sec, lay = cs2Section("silent","SILENT AIM",Color3.fromRGB(100,200,255))
    cs2Toggle(sec,"Silent Aim Enabled",function() return CS2.silentEnabled end,function(v) CS2.silentEnabled=v; startSilentAim() end)
    cs2Slider(sec,"FOV Radius (px)",10,400,function() return CS2.silentFOV end,function(v) CS2.silentFOV=v end,"%d px",1)
    cs2Dropdown(sec,"Target Part",{"Head","HumanoidRootPart","Torso","UpperTorso"},function() return CS2.silentPart end,function(v) CS2.silentPart=v end)
    cs2Separator(sec,"RIG DETECTION")
    cs2Toggle(sec,"Universal Rig Check",function() return CS2.silentRigCheck end,function(v) CS2.silentRigCheck=v end,"Handles R6, R15, custom rigs (Arsenal, Rivals, etc.)")
    cs2Separator(sec,"CHECKS")
    cs2Toggle(sec,"Team Check",function() return CS2.silentTeamCheck end,function(v) CS2.silentTeamCheck=v end)
    cs2Toggle(sec,"NPC Check",function() return CS2.silentNPCCheck end,function(v) CS2.silentNPCCheck=v end)
end

-- TARGET AIMBOT
do
    local sec, lay = cs2Section("target","TARGET AIMBOT",Color3.fromRGB(255,100,200))
    cs2Toggle(sec,"Target Aimbot Enabled",function() return CS2.targetEnabled end,function(v) CS2.targetEnabled=v; startTargetAimbot() end)
    cs2Toggle(sec,"Show Lock Line",function() return CS2.targetShowLine end,function(v) CS2.targetShowLine=v; if not v then clearTargetLine() end end,"Pink beam to locked target")
    cs2Separator(sec,"TARGETING")
    cs2Dropdown(sec,"Target Part",{"Head","HumanoidRootPart","Torso","UpperTorso"},function() return CS2.targetPart end,function(v) CS2.targetPart=v end)
    cs2Dropdown(sec,"Hold Key",{"E","Q","R","T","G","F","X","Z","C","V","LeftShift"},function() return CS2.targetKey end,function(v) CS2.targetKey=v end)
    cs2Separator(sec,"FOV & SMOOTHING")
    cs2Slider(sec,"FOV Radius (px)",10,400,function() return CS2.targetFOV end,function(v) CS2.targetFOV=v end,"%d px",1)
    cs2Slider(sec,"Smoothing",0.01,0.99,function() return CS2.targetSmoothing end,function(v) CS2.targetSmoothing=v end,"%.2f",0.01)
    cs2Slider(sec,"Prediction",0,0.5,function() return CS2.targetPred end,function(v) CS2.targetPred=v end,"%.3f",0.005)
    cs2Separator(sec,"CHECKS")
    cs2Toggle(sec,"Team Check",function() return CS2.targetTeamCheck end,function(v) CS2.targetTeamCheck=v end)
    cs2Toggle(sec,"NPC Check",function() return CS2.targetNPCCheck end,function(v) CS2.targetNPCCheck=v end)
end

-- HITBOX EXPANDER
do
    local sec, lay = cs2Section("hitbox","HITBOX EXPANDER",Color3.fromRGB(200,255,100))
    cs2Toggle(sec,"Hitbox Expander Enabled",function() return CS2.hitboxEnabled end,function(v) CS2.hitboxEnabled=v; if not v then applyHitbox(false) end end)
    cs2Toggle(sec,"Show Hitboxes",function() return CS2.hitboxVisible end,function(v) CS2.hitboxVisible=v end,"Red wireframe on expanded parts")
    cs2Slider(sec,"Hitbox Size",1,30,function() return CS2.hitboxSize end,function(v) CS2.hitboxSize=v end,"%.1f studs",0.5)
    cs2Dropdown(sec,"Expand Part",{"HumanoidRootPart","Head","Torso","UpperTorso","All"},function() return CS2.hitboxPart end,function(v) CS2.hitboxPart=v end)
    cs2Separator(sec,"CHECKS")
    cs2Toggle(sec,"Team Check",function() return CS2.hitboxTeamCheck end,function(v) CS2.hitboxTeamCheck=v end)
    cs2Toggle(sec,"NPC Check",function() return CS2.hitboxNPCCheck end,function(v) CS2.hitboxNPCCheck=v end)
end

-- ESP
do
    local sec, lay = cs2Section("esp","ESP",Color3.fromRGB(0,220,180))
    cs2Toggle(sec,"ESP Enabled",function() return CS2.espEnabled end,function(v) CS2.espEnabled=v; if not v then clearESP() end end)
    cs2Separator(sec,"ESP TYPES")
    cs2Toggle(sec,"Box / Highlight",function() return CS2.espBoxes end,function(v) CS2.espBoxes=v; clearESP() end,"Outline box around players")
    cs2Toggle(sec,"Chams (fill)",function() return CS2.espChams end,function(v) CS2.espChams=v; clearESP() end,"Semi-transparent fill through walls")
    cs2Toggle(sec,"Names",function() return CS2.espNames end,function(v) CS2.espNames=v end)
    cs2Toggle(sec,"Health Bar",function() return CS2.espHealth end,function(v) CS2.espHealth=v end)
    cs2Toggle(sec,"Distance",function() return CS2.espDistance end,function(v) CS2.espDistance=v end)
    cs2Toggle(sec,"Tracers",function() return CS2.espTracers end,function(v) CS2.espTracers=v end,"Line from screen edge to player")
    cs2Separator(sec,"COLORS")
    cs2ColorRow(sec,"Enemy Color",CS2.espBoxColor,"")
    cs2ColorRow(sec,"Team Color",CS2.espTeamColor,"")
    cs2Separator(sec,"SETTINGS")
    cs2Slider(sec,"Max Distance",50,2000,function() return CS2.espMaxDist end,function(v) CS2.espMaxDist=v; for _,b in pairs(espBillboards) do pcall(function() b.MaxDistance=v end) end end,"%d studs",10)
    cs2Toggle(sec,"Team Check",function() return CS2.espTeamCheck end,function(v) CS2.espTeamCheck=v; clearESP() end,"Use different color for teammates")
end

-- MOVEMENT
do
    local sec, lay = cs2Section("movement","MOVEMENT",Color3.fromRGB(100,180,255))
    cs2Toggle(sec,"Infinite Jump",function() return CS2.infiniteJumpEnabled end,function(v) CS2.infiniteJumpEnabled=v; applyInfiniteJump(v) end)
    cs2Toggle(sec,"Noclip",function() return CS2.noclipEnabled end,function(v) CS2.noclipEnabled=v; applyNoclip(v) end)
    cs2Separator(sec,"SPEED MACRO")
    cs2Toggle(sec,"Speed Enabled",function() return CS2.speedEnabled end,function(v) CS2.speedEnabled=v; applySpeed(v) end)
    cs2Dropdown(sec,"Speed Mode",{"WalkSpeed","JumpPower","Both"},function() return CS2.speedMode end,function(v) CS2.speedMode=v; if CS2.speedEnabled then applySpeed(true) end end)
    cs2Slider(sec,"WalkSpeed",2,500,function() return CS2.speedValue end,function(v) CS2.speedValue=v; if CS2.speedEnabled then applySpeed(true) end end,"%d",1)
end

-- VISUALS
do
    local sec, lay = cs2Section("visuals","VISUALS",Color3.fromRGB(255,220,80))
    cs2Toggle(sec,"Fullbright",function() return CS2.fullbrightEnabled end,function(v) CS2.fullbrightEnabled=v; applyFullbright(v) end,"Max ambient, no shadows")
    cs2Toggle(sec,"Remove Fog",function() return CS2.noFogEnabled end,function(v) CS2.noFogEnabled=v; applyNoFog(v) end)
    cs2Separator(sec,"ATMOSPHERE")
    -- Sun/Time
    local function setTime(h)
        pcall(function() Lighting.TimeOfDay = string.format("%02d:00:00", h) end)
    end
    cs2Dropdown(sec,"Time of Day",{"Default","12:00 Noon","06:00 Dawn","18:00 Dusk","00:00 Night"},function() return "Default" end,function(v)
        if v=="12:00 Noon" then setTime(12)
        elseif v=="06:00 Dawn" then setTime(6)
        elseif v=="18:00 Dusk" then setTime(18)
        elseif v=="00:00 Night" then setTime(0) end
    end)
    cs2Dropdown(sec,"Remove Effects",{"None","Blur","ColorCorrection","SunRays","Bloom","All"},function() return "None" end,function(v)
        local targets = v=="All" and {"BlurEffect","ColorCorrectionEffect","SunRaysEffect","BloomEffect"} or {v.."Effect"}
        if v=="None" then return end
        for _,eff in ipairs(Lighting:GetDescendants()) do
            for _,t in ipairs(targets) do if eff:IsA(t) then eff.Enabled=false end end
        end
    end)
    cs2Separator(sec,"DEBUG")
    local statsBtn = Instance.new("TextButton", sec); statsBtn.Size=UDim2.new(1,0,0,34); statsBtn.BackgroundColor3=Color3.fromRGB(45,45,48); statsBtn.BorderSizePixel=0; statsBtn.Text="Show Game Stats"; statsBtn.TextColor3=Color3.fromRGB(220,220,220); statsBtn.TextSize=12; statsBtn.Font=Enum.Font.Gotham; Instance.new("UICorner",statsBtn).CornerRadius=UDim.new(0,4)
    statsBtn.MouseButton1Click:Connect(function()
        notify("Stats","FPS: "..math.floor(1/RunService.Heartbeat:Wait()).."  |  Ping: ~"..(Players.LocalPlayer.NetworkOwnershipAuto and "?" or "?").."ms","info")
    end)
end

-- Show first category by default
cs2ShowCat("aimlock")

-- cleanup on destroy
screenGui.Destroying:Connect(function()
    pcall(function() cs2Disconnect(); clearESP(); clearHitboxVisuals(); clearTargetLine(); applyHitbox(false); applySpeed(false); applyNoclip(false); applyFullbright(false); applyNoFog(false); if infJumpConn then infJumpConn:Disconnect() end; if silentConn then silentConn:Disconnect() end end)
end)

end)() -- end CS2 IIFE

--------------------------------------------------------------
-- INITIALIZE
--------------------------------------------------------------
switchTab(1); updateCombatLists()

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("  // Tempest v3.2 Loaded")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("  âœ“ Key System: VERIFIED")
print("  âœ“ Anti-Kick + Value Limiter Protection: ACTIVE")
print("  âœ“ Script Neutralization Engine: READY")
print("  âœ“ Remote Interception: READY")
print("  âœ“ Zero-Lag Notification Pool: ACTIVE (max "..MAX_VISIBLE_NOTIFS..")")
print("  âœ“ Chat Bubble Filter: ACTIVE")
print("  âœ“ Billboard Editor + Combat Tools")
print("  F2=Toggle | F3=Scan | F4=Toggle BB | F5=Switch Screen")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")

notify("// Tempest v3.2","Key Verified Â· Anti-Kick Active Â· Chat Bubbles Filtered\nF2=Toggle | F5=Switch Screen","success")
